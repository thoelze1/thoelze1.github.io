<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-01-06 Fri 14:00 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SICP Exercises</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Tanner Hoelzel" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">SICP Exercises</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd7fd4a2">Chapter 1</a>
<ul>
<li><a href="#org458e8fb">Notes</a></li>
<li><a href="#org280ae56">Section 1.1</a>
<ul>
<li><a href="#orga4ce1e4">Exercise 1.3</a></li>
<li><a href="#org27873f1">Exercise 1.6</a></li>
</ul>
</li>
<li><a href="#orgdff8735">Section 1.2</a>
<ul>
<li><a href="#orgd495443">Exercise 1.9</a></li>
<li><a href="#orgd85fdc5">Exercise 1.11</a></li>
<li><a href="#org42ac906">Exercise 1.12</a></li>
<li><a href="#org18f7aa4">Exercise 1.16</a></li>
<li><a href="#org4a02bb4">Exercise 1.17</a></li>
<li><a href="#org044953f">Exercise 1.18</a></li>
<li><a href="#orge17c774">Exercise 1.19</a></li>
<li><a href="#org3814d4e">Exercise 1.22</a></li>
<li><a href="#org938a5b0">Exercise 1.26</a></li>
<li><a href="#org12c4a89">Exercise 1.27</a></li>
</ul>
</li>
<li><a href="#org9919842">Section 1.3</a>
<ul>
<li><a href="#org5b7e25f">Exercise 1.29</a></li>
<li><a href="#org9381477">Exercise 1.30</a></li>
<li><a href="#org3adc820">Exercise 1.31</a></li>
<li><a href="#org696a9b0">Exercise 1.32</a></li>
<li><a href="#orgfc6054a">Exercise 1.33</a></li>
<li><a href="#org43447c3">Exercise 1.35</a></li>
<li><a href="#org5d53b46">Exercise 1.36</a></li>
<li><a href="#orgea27843">Exercise 1.37</a></li>
<li><a href="#org9e359f4">Exercise 1.38</a></li>
<li><a href="#org441c516">Exercise 1.39</a></li>
<li><a href="#org7b44dd4">Exercise 1.40</a></li>
<li><a href="#orgebb32e3">Exercise 1.41</a></li>
<li><a href="#orgb516110">Exercise 1.42</a></li>
<li><a href="#orge4ebc4d">Exercise 1.43</a></li>
<li><a href="#orgdb62506">Exercise 1.44</a></li>
<li><a href="#orgd6cd235">Exercise 1.45</a></li>
<li><a href="#org081453e">Exercise 1.46</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2c53aad">Chapter 2</a>
<ul>
<li><a href="#org4e28f8d">Section 2.1</a>
<ul>
<li><a href="#org559ada8">Exercise 2.1</a></li>
<li><a href="#org0b5e766">Exercise 2.2</a></li>
<li><a href="#orgc45e052">Exercise 2.3</a></li>
<li><a href="#org189a224">Exercise 2.4</a></li>
<li><a href="#org8b60b4d">Exercise 2.5</a></li>
<li><a href="#org5a3b8a5">Exercise 2.6</a></li>
<li><a href="#org28ea4f4">Exercise 2.7</a></li>
<li><a href="#org229cdef">Exercise 2.8</a></li>
<li><a href="#org8396d08">Exercise 2.9</a></li>
<li><a href="#orgee962c1">Exercise 2.10</a></li>
<li><a href="#org555c05e">Exercise 2.11</a></li>
<li><a href="#org247478b">Exercise 2.12</a></li>
<li><a href="#org4323988">Exercise 2.13</a></li>
<li><a href="#orgc83d97e">Exercise 2.14</a></li>
</ul>
</li>
<li><a href="#org2a64ba4">Section 2.2</a>
<ul>
<li><a href="#org45882bb">Exercise 2.17</a></li>
<li><a href="#org5312d70">Exercise 2.18</a></li>
<li><a href="#org264fb7b">Exercise 2.19</a></li>
<li><a href="#org9fd410c">Exercise 2.20</a></li>
<li><a href="#org0b31535">Exercise 2.21</a></li>
<li><a href="#org60b3dfd">Exercise 2.22</a></li>
<li><a href="#org5323a89">Exercise 2.23</a></li>
<li><a href="#org90e2a81">Exercise 2.25</a></li>
<li><a href="#org56d4ce3">Exercise 2.27</a></li>
<li><a href="#orgaf060e0">Exercise 2.28</a></li>
<li><a href="#orgd6fc44a">Exercise 2.29</a></li>
<li><a href="#org5a8ea68">Exercise 2.30</a></li>
<li><a href="#org7231783">Exercise 2.31</a></li>
<li><a href="#org16a8ccd">Exercise 2.32</a></li>
<li><a href="#org4753d39">Exercise 2.33</a></li>
<li><a href="#org3ab1d76">Exercise 2.34</a></li>
<li><a href="#orgad11e42">Exercise 2.35</a></li>
<li><a href="#orgdf1653b">Exercise 2.36</a></li>
<li><a href="#org5dc61c1">Exercise 2.37</a></li>
<li><a href="#org7914ad3">Exercise 2.38</a></li>
<li><a href="#orgeb2f9ca">Exercise 2.39</a></li>
<li><a href="#orga0162c2">Exercise 2.40</a></li>
<li><a href="#org60c9fdd">Exercise 2.41</a></li>
<li><a href="#orgb7f7a93">Exercise 2.42</a></li>
<li><a href="#orgc1430d4">Exercise 2.43</a></li>
<li><a href="#orga0a3945">Exercise 2.44</a></li>
<li><a href="#org01ecff8">Exercise 2.45</a></li>
<li><a href="#org48a3b61">Exercise 2.46</a></li>
<li><a href="#org339d705">Exercise 2.47</a></li>
<li><a href="#orgf4e85d0">Exercise 2.48</a></li>
<li><a href="#org2978a93">Exercise 2.49</a></li>
<li><a href="#org3bc60ce">Exercise 2.51</a></li>
</ul>
</li>
<li><a href="#org33ff3aa">Section 2.3</a>
<ul>
<li><a href="#org1150912">Exercise 2.53</a></li>
<li><a href="#org1db27ba">Exercise 2.54</a></li>
<li><a href="#orgbad9df6">Exercise 2.55</a></li>
<li><a href="#org23c9833">Exercise 2.56</a></li>
<li><a href="#orgaeac6be">Exercise 2.57</a></li>
<li><a href="#org6a421ff">Exercise 2.58</a></li>
<li><a href="#org6808a0b">Exercise 2.59</a></li>
<li><a href="#orged916a5">Exercise 2.60</a></li>
<li><a href="#orgf0d85f3">Exercise 2.61</a></li>
<li><a href="#orgc3df2e8">Exercise 2.62</a></li>
<li><a href="#org8ff9ed6">Exercise 2.63</a></li>
<li><a href="#org1b83e1d">Exercise 2.64</a></li>
<li><a href="#orge27f686">Exercise 2.65</a></li>
<li><a href="#org3f5f504">Exercise 2.67</a></li>
<li><a href="#org8c63945">Exercise 2.68</a></li>
<li><a href="#org9958d17">Exercise 2.69</a></li>
<li><a href="#org865ab1c">Exercise 2.70</a></li>
<li><a href="#org6abd4b9">Exercise 2.71</a></li>
<li><a href="#org493be07">Exercise 2.72</a></li>
</ul>
</li>
<li><a href="#orgdede9c5">Section 2.4</a>
<ul>
<li><a href="#orgbd47114">Exercise 2.73</a></li>
</ul>
</li>
<li><a href="#orgfac3fb6">Section 2.5</a>
<ul>
<li><a href="#org26684d3">Exercise 2.77</a></li>
<li><a href="#orgadd2c47">Exercise 2.78</a></li>
<li><a href="#org01def75">Exercise 2.79</a></li>
<li><a href="#org1748131">Exercise 2.80</a></li>
<li><a href="#org717aa90">Exercise 2.81</a></li>
<li><a href="#orgc2f36e8">Exercise 2.82</a></li>
<li><a href="#org22827f2">Exercise 2.83</a></li>
<li><a href="#org1a422e8">Exercise 2.84</a></li>
<li><a href="#org3ba3d7c">Exercise 2.85</a></li>
<li><a href="#org0b3f40f">Exercise 2.86</a></li>
<li><a href="#org6c81fdc">Exercise 2.87</a></li>
<li><a href="#orgdb9e2be">Exercise 2.88</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgd7fd4a2" class="outline-2">
<h2 id="orgd7fd4a2">Chapter 1</h2>
<div class="outline-text-2" id="text-orgd7fd4a2">
</div>
<div id="outline-container-org458e8fb" class="outline-3">
<h3 id="org458e8fb">Notes</h3>
<div class="outline-text-3" id="text-org458e8fb">
<p>
A recursive procedure is simply one that calls itself by name. It is
not necessarily a recursive process.
</p>
<blockquote>
<p>
Programs must be written for people to read, and only incidentally
for computers to execute
</p>
</blockquote>
<blockquote>
<p>
The set of expressions for which a binding defines a name is called
the scope of that name
</p>
</blockquote>
<p>
<kbd>let</kbd> is syntactic sugar for <kbd>lambda</kbd> application
</p>
<blockquote>
<p>
The general technique of isolating the parts of a program that deal
with how data objects are represented from the parts of a program
that deal with how data objects are used is a powerful design
methodology called "data abstraction".
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org280ae56" class="outline-3">
<h3 id="org280ae56">Section 1.1</h3>
<div class="outline-text-3" id="text-org280ae56">
</div>
<div id="outline-container-orga4ce1e4" class="outline-4">
<h4 id="orga4ce1e4">Exercise 1.3</h4>
<div class="outline-text-4" id="text-orga4ce1e4">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* x x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum-of-squares-of-largest</span> a b c<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>- <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>square a<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>square b<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>square c<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
     <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #94BFF3;">(</span>&lt; a b<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>&lt; a c<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span> a<span style="color: #93E0E3;">)</span>
           <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>&lt; b c<span style="color: #9FC59F;">)</span> b<span style="color: #93E0E3;">)</span>
           <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> c<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org27873f1" class="outline-4">
<h4 id="org27873f1">Exercise 1.6</h4>
<div class="outline-text-4" id="text-org27873f1">
<p>
Enters a recursive loop not because <kbd>cond</kbd> is used instead of <kbd>if</kbd> but
because a function call is used instead of <kbd>if</kbd> or <kbd>cond</kbd>. If <kbd>new-if</kbd>
were implemented with <kbd>if</kbd> instead of <kbd>cond</kbd>, the code would also
enter an infinite loop.
</p>
</div>
</div>
</div>
<div id="outline-container-orgdff8735" class="outline-3">
<h3 id="orgdff8735">Section 1.2</h3>
<div class="outline-text-3" id="text-orgdff8735">
</div>
<div id="outline-container-orgd495443" class="outline-4">
<h4 id="orgd495443">Exercise 1.9</h4>
<div class="outline-text-4" id="text-orgd495443">
<p>
Recursive:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>+ 4 5<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>+ <span style="color: #D0BF8F;">(</span>dec 4<span style="color: #D0BF8F;">)</span> 5<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>+ 3 5<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>dec 3<span style="color: #93E0E3;">)</span> 5<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc <span style="color: #D0BF8F;">(</span>+ 2 5<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc <span style="color: #D0BF8F;">(</span>inc <span style="color: #93E0E3;">(</span>+ <span style="color: #9FC59F;">(</span>dec 2<span style="color: #9FC59F;">)</span> 5<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc <span style="color: #D0BF8F;">(</span>inc <span style="color: #93E0E3;">(</span>+ 1 5<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc <span style="color: #D0BF8F;">(</span>inc <span style="color: #93E0E3;">(</span>inc <span style="color: #9FC59F;">(</span>+ <span style="color: #94BFF3;">(</span>dec 1<span style="color: #94BFF3;">)</span> 5<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc <span style="color: #D0BF8F;">(</span>inc <span style="color: #93E0E3;">(</span>inc <span style="color: #9FC59F;">(</span>+ 0 5<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc <span style="color: #D0BF8F;">(</span>inc <span style="color: #93E0E3;">(</span>inc 5<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc <span style="color: #D0BF8F;">(</span>inc 6<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc <span style="color: #BFEBBF;">(</span>inc 7<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>inc 8<span style="color: #DCDCCC;">)</span>
9
</pre>
</div>
<p>
Iterative:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>+ 4 5<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>+ <span style="color: #BFEBBF;">(</span>dec 4<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>inc 5<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>+ 3 6<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>+ <span style="color: #BFEBBF;">(</span>dec 3<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>inc 6<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>+ 2 7<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>+ <span style="color: #BFEBBF;">(</span>dec 2<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>inc 7<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>+ 1 8<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>+ <span style="color: #BFEBBF;">(</span>dec 1<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>inc 8<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>+ 0 9<span style="color: #DCDCCC;">)</span>
9
</pre>
</div>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-count-change</span> amt values<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? values<span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>&lt; amt 0<span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= amt 0<span style="color: #93E0E3;">)</span> 1<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>+ <span style="color: #9FC59F;">(</span>my-count-change <span style="color: #94BFF3;">(</span>- amt <span style="color: #E0CF9F;">(</span>car values<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> values<span style="color: #9FC59F;">)</span>
                 <span style="color: #9FC59F;">(</span>my-count-change amt <span style="color: #94BFF3;">(</span>cdr values<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">count-change</span> amt<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">cc</span> amount kinds-of-coins<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= amount 0<span style="color: #9FC59F;">)</span> 1<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #94BFF3;">(</span>&lt; amount 0<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>= kinds-of-coins 0<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span> 0<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>+ <span style="color: #94BFF3;">(</span>cc amount
                       <span style="color: #E0CF9F;">(</span>- kinds-of-coins 1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                   <span style="color: #94BFF3;">(</span>cc <span style="color: #E0CF9F;">(</span>- amount
                          <span style="color: #8FB28F;">(</span>first-denomination kinds-of-coins<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span>
                       kinds-of-coins<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">first-denomination</span> kinds-of-coins<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= kinds-of-coins 1<span style="color: #9FC59F;">)</span> 1<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= kinds-of-coins 2<span style="color: #9FC59F;">)</span> 5<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= kinds-of-coins 3<span style="color: #9FC59F;">)</span> 10<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= kinds-of-coins 4<span style="color: #9FC59F;">)</span> 25<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= kinds-of-coins 5<span style="color: #9FC59F;">)</span> 50<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cc amt 5<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd85fdc5" class="outline-4">
<h4 id="orgd85fdc5">Exercise 1.11</h4>
<div class="outline-text-4" id="text-orgd85fdc5">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">f</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&lt; n 3<span style="color: #D0BF8F;">)</span>
      n
      <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>* 1 <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>- n 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>* 2 <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>- n 2<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>* 3 <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>- n 3<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">f-iter</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iterate</span> a b c count<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= count 0<span style="color: #93E0E3;">)</span>
        a
        <span style="color: #93E0E3;">(</span>iterate b
                c
                <span style="color: #9FC59F;">(</span>+ c
                   <span style="color: #94BFF3;">(</span>* b 2<span style="color: #94BFF3;">)</span>
                   <span style="color: #94BFF3;">(</span>* a 3<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
                <span style="color: #9FC59F;">(</span>- count 1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iterate 0 1 2 n<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org42ac906" class="outline-4">
<h4 id="org42ac906">Exercise 1.12</h4>
<div class="outline-text-4" id="text-org42ac906">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">pascal</span> n m<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #93E0E3;">(</span>= m 0<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span>= m n<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      1
      <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>pascal <span style="color: #9FC59F;">(</span>- n 1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>- m 1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>pascal <span style="color: #9FC59F;">(</span>- n 1<span style="color: #9FC59F;">)</span> m<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org18f7aa4" class="outline-4">
<h4 id="org18f7aa4">Exercise 1.16</h4>
<div class="outline-text-4" id="text-org18f7aa4">
<p>
If \(n\) is even:
\[b \to b^{2}\]
\[n \to \frac{n}{2} - 1\]
\[c \to cb^{2}\]
If \(n\) is odd:
\[b \to b\]
\[n \to n - 1\]
\[c \to cb\]
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fast-expt</span> base exp<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">fast-iter</span> b n c<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= n 0<span style="color: #9FC59F;">)</span> c<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>even? n<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>fast-iter <span style="color: #94BFF3;">(</span>* b b<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>- <span style="color: #E0CF9F;">(</span>/ n 2<span style="color: #E0CF9F;">)</span> 1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>* c <span style="color: #E0CF9F;">(</span>* b b<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>fast-iter b <span style="color: #94BFF3;">(</span>- n 1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>* c b<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fast-iter base exp 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">even?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>remainder n 2<span style="color: #D0BF8F;">)</span> 0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">And so here are all of the combinations of space-/time-complexity</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">we've seen so far:</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-expt</span> b n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= n 0<span style="color: #D0BF8F;">)</span>
      1
      <span style="color: #D0BF8F;">(</span>* b <span style="color: #93E0E3;">(</span>my-expt b <span style="color: #9FC59F;">(</span>- n 1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-expt-iter</span> base pow<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iterate</span> n c<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= n 0<span style="color: #9FC59F;">)</span> c<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>iterate <span style="color: #94BFF3;">(</span>- n 1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>* base c<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iterate pow 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-expt-log</span> base pow<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= pow 0<span style="color: #93E0E3;">)</span> 1<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>even? pow<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>square <span style="color: #9FC59F;">(</span>my-expt-log base <span style="color: #94BFF3;">(</span>/ pow 2<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>* base <span style="color: #9FC59F;">(</span>my-expt-log base <span style="color: #94BFF3;">(</span>- pow 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-expt-iter-log</span> base pow<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iterate</span> b p c<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= p 0<span style="color: #9FC59F;">)</span> c<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>even? p<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>iterate <span style="color: #94BFF3;">(</span>* b b<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>/ p 2<span style="color: #94BFF3;">)</span> c<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>iterate b <span style="color: #94BFF3;">(</span>- p 1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>* b c<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iterate base pow 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4a02bb4" class="outline-4">
<h4 id="org4a02bb4">Exercise 1.17</h4>
<div class="outline-text-4" id="text-org4a02bb4">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">halve</span> b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ b 2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">double</span> b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>+ b b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">mult</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= b 0<span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>even? b<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>double <span style="color: #9FC59F;">(</span>mult a <span style="color: #94BFF3;">(</span>halve b<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>+ a <span style="color: #9FC59F;">(</span>mult a <span style="color: #94BFF3;">(</span>- b 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org044953f" class="outline-4">
<h4 id="org044953f">Exercise 1.18</h4>
<div class="outline-text-4" id="text-org044953f">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fast-mult</span> x y<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">fast-mult-iter</span> a b c<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= b 0<span style="color: #9FC59F;">)</span> c<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>even? b<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>fast-mult-iter <span style="color: #94BFF3;">(</span>double a<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>- <span style="color: #E0CF9F;">(</span>halve b<span style="color: #E0CF9F;">)</span> 1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>+ c <span style="color: #E0CF9F;">(</span>double a<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>fast-mult-iter a <span style="color: #94BFF3;">(</span>- b 1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>+ c a<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fast-mult-iter x y 0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge17c774" class="outline-4">
<h4 id="orge17c774">Exercise 1.19</h4>
<div class="outline-text-4" id="text-orge17c774">
<p>
If we use as a representation for the iterative fibonacci process a
transformation \(T_{p,q}\) defined as:
\[a \leftarrow bq + aq + ap\]
\[b \leftarrow bp + aq\]
Then $t<sub>p',q'</sub> = \(T_{p,q} \circ T_{p,q}\) is:
\[a \leftarrow (bp + aq)q + (bq + aq + ap)q + (bq + aq + ap)p\]
\[b \leftarrow (bp + aq)p + (bq + aq + ap)q\]
We'll rewrite this to determine p' and q':
\[a \leftarrow b(2pq+q^2) + a(2q^2 + 2qp + p^2)\]
\[b \leftarrow b(p^2+q^2) + a(2qp+q^2)\]
Therefore \(p' = p^2+q^2\) and \(q' = 2pq+q^2\).
</p>

<p>
The exercise doesn't elucidate the origin of this cleverly defined
transformation. Apparently it's called the "Fibonacci Q-Matrix" and
originated in the 1950s (see <a href="https://stackoverflow.com/questions/1896974/sicp-exercise-1-19">stackoverflow</a> for more).
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fib</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">fib-iter</span> a b p q count<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= count 0<span style="color: #9FC59F;">)</span> b<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>even? count<span style="color: #9FC59F;">)</span>
           <span style="color: #9FC59F;">(</span>fib-iter a
                     b
                     <span style="color: #94BFF3;">(</span>+ <span style="color: #E0CF9F;">(</span>square p<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>square q<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                     <span style="color: #94BFF3;">(</span>+ <span style="color: #E0CF9F;">(</span>* 2 p q<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>square q<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                     <span style="color: #94BFF3;">(</span>/ count 2<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>fib-iter <span style="color: #94BFF3;">(</span>+ <span style="color: #E0CF9F;">(</span>* b q<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>* a q<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>* a p<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                          <span style="color: #94BFF3;">(</span>+ <span style="color: #E0CF9F;">(</span>* b p<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>* a q<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                          p
                          q
                          <span style="color: #94BFF3;">(</span>- count 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fib-iter 1 0 0 1 n<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-expmod</span> base exp mod<span style="color: #BFEBBF;">)</span>
  <span style="color: #CC9393;">"Generates an iterative process that runs in a logarithmic number of steps"</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iterate</span> b e i<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= e 0<span style="color: #9FC59F;">)</span> i<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>even? e<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>iterate <span style="color: #94BFF3;">(</span>remainder <span style="color: #E0CF9F;">(</span>* b b<span style="color: #E0CF9F;">)</span> mod<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>/ e 2<span style="color: #94BFF3;">)</span> i<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>iterate b <span style="color: #94BFF3;">(</span>- e 1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>remainder <span style="color: #E0CF9F;">(</span>* b i<span style="color: #E0CF9F;">)</span> mod<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iterate base exp 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3814d4e" class="outline-4">
<h4 id="org3814d4e">Exercise 1.22</h4>
<div class="outline-text-4" id="text-org3814d4e">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">timed-prime-test</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>newline<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>start-prime-test n <span style="color: #D0BF8F;">(</span>runtime<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">start-prime-test</span> n start-time<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>prime? n<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>report-prime <span style="color: #93E0E3;">(</span>- <span style="color: #9FC59F;">(</span>runtime<span style="color: #9FC59F;">)</span> start-time<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">report-prime</span> elapsed-time<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">" *** "</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display elapsed-time<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">search-for-primes</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>&lt; a b<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>timed-prime-test a<span style="color: #93E0E3;">)</span>
                 <span style="color: #93E0E3;">(</span>search-for-primes <span style="color: #9FC59F;">(</span>+ a 1<span style="color: #9FC59F;">)</span> b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">prime?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iterate</span> i<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= <span style="color: #94BFF3;">(</span>remainder n i<span style="color: #94BFF3;">)</span> 0<span style="color: #9FC59F;">)</span> #f<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>&gt; <span style="color: #94BFF3;">(</span>* i i<span style="color: #94BFF3;">)</span> n<span style="color: #9FC59F;">)</span> #t<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>iterate <span style="color: #94BFF3;">(</span>+ i 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iterate 2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org938a5b0" class="outline-4">
<h4 id="org938a5b0">Exercise 1.26</h4>
<div class="outline-text-4" id="text-org938a5b0">
<p>
From a high level, calling <kbd>expmod</kbd> with <kbd>(/ exp 2)</kbd> halves the
problem. It is this halving, at each iteration of the process, that
allows it to run in a number of steps that is logarithmically
related to the size of the input. When Louis calls <kbd>expmod</kbd> twice,
each with a halved problem (the same half) he is doing twice of
half of the original amount of work. Therefore he is doing the
original amount of work, which in the case of computing an exponent
would be \(n\) multiplications where \(n\) is the power being raised to.
</p>
</div>
</div>
<div id="outline-container-org12c4a89" class="outline-4">
<h4 id="org12c4a89">Exercise 1.27</h4>
<div class="outline-text-4" id="text-org12c4a89">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fermat-condition?</span> a n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>my-expmod a n n<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>remainder a n<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fermat-test?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">satisfies?</span> a<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>&gt;= a n<span style="color: #9FC59F;">)</span> #t<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>fermat-condition? a n<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>satisfies? <span style="color: #94BFF3;">(</span>+ a 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> #f<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>satisfies? 2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">carmichael?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>not <span style="color: #93E0E3;">(</span>prime? n<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>fermat-test? n<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9919842" class="outline-3">
<h3 id="org9919842">Section 1.3</h3>
<div class="outline-text-3" id="text-org9919842">
</div>
<div id="outline-container-org5b7e25f" class="outline-4">
<h4 id="org5b7e25f">Exercise 1.29</h4>
<div class="outline-text-4" id="text-org5b7e25f">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">simp</span> f a b n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">h</span> <span style="color: #D0BF8F;">(</span>/ <span style="color: #93E0E3;">(</span>- b a<span style="color: #93E0E3;">)</span> n<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">step</span> x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>+ x h h<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">cf</span> c x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>* c <span style="color: #93E0E3;">(</span>f x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">2f</span> x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>cf 2 x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">4f</span> x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>cf 4 x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* <span style="color: #D0BF8F;">(</span>/ h 3.0<span style="color: #D0BF8F;">)</span>
     <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>f a<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>sum 4f <span style="color: #9FC59F;">(</span>+ a h<span style="color: #9FC59F;">)</span> step b<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>sum 2f <span style="color: #9FC59F;">(</span>+ a h h<span style="color: #9FC59F;">)</span> step b<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>f b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9381477" class="outline-4">
<h4 id="org9381477">Exercise 1.30</h4>
<div class="outline-text-4" id="text-org9381477">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum</span> term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> a result<span style="color: #D0BF8F;">)</span>
     <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>&gt; a b<span style="color: #93E0E3;">)</span>
         result
         <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>+ result <span style="color: #94BFF3;">(</span>term a<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter a 0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3adc820" class="outline-4">
<h4 id="org3adc820">Exercise 1.31</h4>
<div class="outline-text-4" id="text-org3adc820">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">product-iter</span> term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> a result<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>&gt; a b<span style="color: #93E0E3;">)</span>
        result
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>* result <span style="color: #94BFF3;">(</span>term a<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter a 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">product</span> term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&gt; a b<span style="color: #D0BF8F;">)</span>
      1
      <span style="color: #D0BF8F;">(</span>* <span style="color: #93E0E3;">(</span>term a<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>product term <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> next b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org696a9b0" class="outline-4">
<h4 id="org696a9b0">Exercise 1.32</h4>
<div class="outline-text-4" id="text-org696a9b0">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">accumulate</span> combiner null-val term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&gt; a b<span style="color: #D0BF8F;">)</span>
      null-val
      <span style="color: #D0BF8F;">(</span>combiner <span style="color: #93E0E3;">(</span>term a<span style="color: #93E0E3;">)</span>
                <span style="color: #93E0E3;">(</span>accumulate combiner null-val term <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> next b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">accumulate-iter</span> combiner null-val term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> a result<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>&gt; a b<span style="color: #93E0E3;">)</span>
        result
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>combiner result <span style="color: #94BFF3;">(</span>term a<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter a null-val<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfc6054a" class="outline-4">
<h4 id="orgfc6054a">Exercise 1.33</h4>
<div class="outline-text-4" id="text-orgfc6054a">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">filtered-accumulate</span> filter combiner null-val term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> a result<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>&gt; a b<span style="color: #9FC59F;">)</span> result<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>filter a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>iter <span style="color: #94BFF3;">(</span>next a<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>combiner result <span style="color: #E0CF9F;">(</span>term a<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>iter <span style="color: #94BFF3;">(</span>next a<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>combiner result null-val<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter a null-val<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum-square-primes</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>filtered-accumulate prime? + 0 square a inc b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">product-coprimes</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">filt</span> a<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>gcd a n<span style="color: #93E0E3;">)</span> 1<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>filtered-accumulate filt * 1 <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x<span style="color: #93E0E3;">)</span> x<span style="color: #D0BF8F;">)</span> 2 inc n<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">gcd</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= b 0<span style="color: #D0BF8F;">)</span>
      a
      <span style="color: #D0BF8F;">(</span>gcd b <span style="color: #93E0E3;">(</span>remainder a b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">factorial</span> b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>product <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x<span style="color: #93E0E3;">)</span> x<span style="color: #D0BF8F;">)</span> 2 <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>+ x 1<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">4square</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* 4 <span style="color: #D0BF8F;">(</span>square x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">4square1</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>- <span style="color: #D0BF8F;">(</span>4square x<span style="color: #D0BF8F;">)</span> 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">inc</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>+ x 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">pi-approx</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* 2.0 <span style="color: #D0BF8F;">(</span>/ <span style="color: #93E0E3;">(</span>product-iter 4square 1 inc n<span style="color: #93E0E3;">)</span>
            <span style="color: #93E0E3;">(</span>product-iter 4square1 1 inc n<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org43447c3" class="outline-4">
<h4 id="org43447c3">Exercise 1.35</h4>
<div class="outline-text-4" id="text-org43447c3">
<p>
\[x^{2} \mapsto x + 1\]
\[x^{2} - x - 1 = 0\]
\[x = \frac{-(-1) \pm \sqrt{(-1)^{2} - 4(-1)}}{2}\]
\[x = \frac{1 \pm \sqrt{5}}{2}\]
</p>
</div>
</div>
<div id="outline-container-org5d53b46" class="outline-4">
<h4 id="org5d53b46">Exercise 1.36</h4>
<div class="outline-text-4" id="text-org5d53b46">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">tolerance</span> 0.00001<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fixed-point</span> f first-guess<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">close-enough?</span> v1 v2<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>&lt; <span style="color: #93E0E3;">(</span>abs <span style="color: #9FC59F;">(</span>- v1 v2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> tolerance<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">try</span> guess<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>newline<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>display guess<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>next <span style="color: #94BFF3;">(</span>f guess<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>close-enough? guess next<span style="color: #9FC59F;">)</span>
          next
          <span style="color: #9FC59F;">(</span>try next<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>try first-guess<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgea27843" class="outline-4">
<h4 id="orgea27843">Exercise 1.37</h4>
<div class="outline-text-4" id="text-orgea27843">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cont-frac</span> n d k<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">recurse</span> i<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= i k<span style="color: #93E0E3;">)</span>
        0
        <span style="color: #93E0E3;">(</span>/ <span style="color: #9FC59F;">(</span>n i<span style="color: #9FC59F;">)</span>
           <span style="color: #9FC59F;">(</span>+ <span style="color: #94BFF3;">(</span>d i<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>recurse <span style="color: #E0CF9F;">(</span>+ i 1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>recurse 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cont-frac</span> n d k<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> i result<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= i 0<span style="color: #93E0E3;">)</span>
        result
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>- i 1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>/ <span style="color: #94BFF3;">(</span>n i<span style="color: #94BFF3;">)</span>
                         <span style="color: #94BFF3;">(</span>+ <span style="color: #E0CF9F;">(</span>d i<span style="color: #E0CF9F;">)</span> result<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter k 0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9e359f4" class="outline-4">
<h4 id="org9e359f4">Exercise 1.38</h4>
<div class="outline-text-4" id="text-org9e359f4">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">e-approx</span> k<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">d</span> k<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= <span style="color: #9FC59F;">(</span>remainder k 3<span style="color: #9FC59F;">)</span> 2<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>+ 2.0 <span style="color: #9FC59F;">(</span>* 2 <span style="color: #94BFF3;">(</span>quotient k 3<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        1.0<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>+ 2 <span style="color: #D0BF8F;">(</span>cont-frac <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #9FC59F;">(</span>x<span style="color: #9FC59F;">)</span> 1.0<span style="color: #93E0E3;">)</span> d k<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org441c516" class="outline-4">
<h4 id="org441c516">Exercise 1.39</h4>
<div class="outline-text-4" id="text-org441c516">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">tan-cf</span> x k<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cont-frac <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>i<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>= i 1<span style="color: #9FC59F;">)</span>
                             x
                             <span style="color: #9FC59F;">(</span>* -1.0 <span style="color: #94BFF3;">(</span>square x<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
             <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>i<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>- <span style="color: #9FC59F;">(</span>* 2 i<span style="color: #9FC59F;">)</span> 1.0<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
             k<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org7b44dd4" class="outline-4">
<h4 id="org7b44dd4">Exercise 1.40</h4>
<div class="outline-text-4" id="text-org7b44dd4">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cubic</span> a b c<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>cube x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>* a <span style="color: #9FC59F;">(</span>square x<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>* b x<span style="color: #93E0E3;">)</span> c<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgebb32e3" class="outline-4">
<h4 id="orgebb32e3">Exercise 1.41</h4>
<div class="outline-text-4" id="text-orgebb32e3">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">double</span> f<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span>f x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb516110" class="outline-4">
<h4 id="orgb516110">Exercise 1.42</h4>
<div class="outline-text-4" id="text-orgb516110">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">compose</span> f g<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span>g x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge4ebc4d" class="outline-4">
<h4 id="orge4ebc4d">Exercise 1.43</h4>
<div class="outline-text-4" id="text-orge4ebc4d">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">repeated</span> f n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= n 1<span style="color: #D0BF8F;">)</span>
      f
      <span style="color: #D0BF8F;">(</span>compose f <span style="color: #93E0E3;">(</span>repeated f <span style="color: #9FC59F;">(</span>- n 1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">repeated-iter</span> f n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> i g<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= i n<span style="color: #93E0E3;">)</span>
        g
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>+ i 1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>compose f g<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter 1 f<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">repeated-log</span> f n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= n 1<span style="color: #93E0E3;">)</span> f<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>even? n<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>repeated-log <span style="color: #9FC59F;">(</span>compose f f<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>/ n 2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>compose f <span style="color: #9FC59F;">(</span>repeated-log f <span style="color: #94BFF3;">(</span>- n 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-orgdb62506" class="outline-4">
<h4 id="orgdb62506">Exercise 1.44</h4>
<div class="outline-text-4" id="text-orgdb62506">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum-list</span> l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? l<span style="color: #D0BF8F;">)</span>
      0
      <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>car l<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>sum-list <span style="color: #9FC59F;">(</span>cdr l<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">average-list</span> l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>sum-list l<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>length l<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">smooth</span> f<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>average-list <span style="color: #93E0E3;">(</span>list <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>- x dx<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
                                  <span style="color: #9FC59F;">(</span>f x<span style="color: #9FC59F;">)</span>
                                  <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>+ x dx<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">n-fold-smoothed</span> f n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #D0BF8F;">(</span>repeated smooth n<span style="color: #D0BF8F;">)</span> f<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-orgd6cd235" class="outline-4">
<h4 id="orgd6cd235">Exercise 1.45</h4>
<div class="outline-text-4" id="text-orgd6cd235">
<p>
In the REPL I see the following:
</p>
<ul class="org-ul">
<li>One average-damp works until fourth roots</li>
<li>Two average-damp's work until eighth roots</li>
<li>Three average-damp's work until sixteenth roots</li>
</ul>
<p>
I see a pattern&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">average-damp</span> f<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>average <span style="color: #93E0E3;">(</span>list x <span style="color: #9FC59F;">(</span>f x<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sqrt</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fixed-point <span style="color: #D0BF8F;">(</span>average-damp <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #9FC59F;">(</span>y<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>/ x y<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
               1.0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">lb</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>log x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>log 2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">nth-root</span> k n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fixed-point
   <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>repeated average-damp <span style="color: #9FC59F;">(</span>floor <span style="color: #94BFF3;">(</span>lb n<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #9FC59F;">(</span>x<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>/ k <span style="color: #94BFF3;">(</span>my-expt x <span style="color: #E0CF9F;">(</span>- n 1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
   1.0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">difference</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>abs <span style="color: #D0BF8F;">(</span>- a b<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">test-nth-root</span> base exp<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>&lt; <span style="color: #D0BF8F;">(</span>difference base
                 <span style="color: #93E0E3;">(</span>nth-root <span style="color: #9FC59F;">(</span>my-expt base exp<span style="color: #9FC59F;">)</span>
                           exp<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
     0.01<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org081453e" class="outline-4">
<h4 id="org081453e">Exercise 1.46</h4>
<div class="outline-text-4" id="text-org081453e">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">iterative-improve</span> good-enough? improve-guess<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>guess<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">(</span><span style="color: #93E0E3;">iterate</span> g<span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>good-enough? g<span style="color: #9FC59F;">)</span>
          g
          <span style="color: #9FC59F;">(</span>iterate <span style="color: #94BFF3;">(</span>improve-guess g<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>iterate guess<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">iterative-improve-sqrt</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #D0BF8F;">(</span>iterative-improve <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #9FC59F;">(</span>g<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>&lt; <span style="color: #94BFF3;">(</span>difference <span style="color: #E0CF9F;">(</span>square g<span style="color: #E0CF9F;">)</span> x<span style="color: #94BFF3;">)</span> 0.001<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
                      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #9FC59F;">(</span>g<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>average <span style="color: #94BFF3;">(</span>list g <span style="color: #E0CF9F;">(</span>/ x g<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> 1.0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">iterative-improve-fixed-point</span> func first-guess<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #D0BF8F;">(</span>iterative-improve <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #9FC59F;">(</span>g<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>&lt; <span style="color: #94BFF3;">(</span>difference g <span style="color: #E0CF9F;">(</span>func g<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> 0.00001<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
                      func<span style="color: #D0BF8F;">)</span> first-guess<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org2c53aad" class="outline-2">
<h2 id="org2c53aad">Chapter 2</h2>
<div class="outline-text-2" id="text-org2c53aad">
</div>
<div id="outline-container-org4e28f8d" class="outline-3">
<h3 id="org4e28f8d">Section 2.1</h3>
<div class="outline-text-3" id="text-org4e28f8d">
</div>
<div id="outline-container-org559ada8" class="outline-4">
<h4 id="org559ada8">Exercise 2.1</h4>
<div class="outline-text-4" id="text-org559ada8">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">same-sign?</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>&gt; <span style="color: #D0BF8F;">(</span>* a b<span style="color: #D0BF8F;">)</span> 0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-rat</span> n d<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>g <span style="color: #9FC59F;">(</span>gcd n d<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>cons <span style="color: #93E0E3;">(</span>* <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>same-sign? n d<span style="color: #E0CF9F;">)</span> 1<span style="color: #94BFF3;">)</span>
                   <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> -1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>abs <span style="color: #94BFF3;">(</span>/ n g<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span>abs <span style="color: #9FC59F;">(</span>/ d g<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">numer</span> x<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">denom</span> x<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cdr x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">print-rat</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>newline<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #D0BF8F;">(</span>numer x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">"/"</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #D0BF8F;">(</span>denom x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org0b5e766" class="outline-4">
<h4 id="org0b5e766">Exercise 2.2</h4>
<div class="outline-text-4" id="text-org0b5e766">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-point</span> x y<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cons x y<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">x-point</span> p<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car p<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">y-point</span> p<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cdr p<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">point-less</span> p1 p2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #D0BF8F;">(</span>&lt; <span style="color: #93E0E3;">(</span>x-point p1<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>x-point p2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #93E0E3;">(</span>= <span style="color: #9FC59F;">(</span>x-point p1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>x-point p2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
           <span style="color: #93E0E3;">(</span>&lt; <span style="color: #9FC59F;">(</span>y-point p1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>y-point p2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">point-equal</span> p1 p2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>x-point p1<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>x-point p2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
       <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>y-point p1<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>y-point p2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">point-equal</span> p1 p2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>not <span style="color: #93E0E3;">(</span>point-less p1 p2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
       <span style="color: #D0BF8F;">(</span>not <span style="color: #93E0E3;">(</span>point-less p2 p1<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-segment</span> start end<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>point-less start end<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cons start end<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>cons end start<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">start-segment</span> seg<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car seg<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">end-segment</span> seg<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cdr seg<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">average</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>+ a b<span style="color: #D0BF8F;">)</span> 2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">midpoint-segment</span> seg<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-point <span style="color: #D0BF8F;">(</span>average <span style="color: #93E0E3;">(</span>x-point <span style="color: #9FC59F;">(</span>start-segment seg<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
                       <span style="color: #93E0E3;">(</span>x-point <span style="color: #9FC59F;">(</span>end-segment seg<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
              <span style="color: #D0BF8F;">(</span>average <span style="color: #93E0E3;">(</span>y-point <span style="color: #9FC59F;">(</span>start-segment seg<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
                       <span style="color: #93E0E3;">(</span>y-point <span style="color: #9FC59F;">(</span>end-segment seg<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">print-point</span> p<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>newline<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">"("</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #D0BF8F;">(</span>x-point p<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">","</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #D0BF8F;">(</span>y-point p<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">")"</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-orgc45e052" class="outline-4">
<h4 id="orgc45e052">Exercise 2.3</h4>
<div class="outline-text-4" id="text-orgc45e052">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-rectangle</span> corner1 corner2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #9FC59F;">(</span>= <span style="color: #94BFF3;">(</span>x-point corner1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>x-point corner2<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>= <span style="color: #94BFF3;">(</span>y-point corner1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>y-point corner2<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>error <span style="color: #CC9393;">"Points define a segment"</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>point-less corner1 corner2<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cons corner1 corner2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>cons corner2 corner1<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">height</span> rect<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>difference <span style="color: #D0BF8F;">(</span>y-point <span style="color: #93E0E3;">(</span>car rect<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>y-point <span style="color: #93E0E3;">(</span>cdr rect<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">width</span> rect<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>difference <span style="color: #D0BF8F;">(</span>x-point <span style="color: #93E0E3;">(</span>car rect<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>x-point <span style="color: #93E0E3;">(</span>cdr rect<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
I won't get much more out of this by continuing&#x2026;
</p>
</div>
</div>
<div id="outline-container-org189a224" class="outline-4">
<h4 id="org189a224">Exercise 2.4</h4>
<div class="outline-text-4" id="text-org189a224">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-cons</span> x y<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>m<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>m x y<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-car</span> z<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>z <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>p q<span style="color: #93E0E3;">)</span> p<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-cdr</span> z<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>z <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>p q<span style="color: #93E0E3;">)</span> q<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
Expansion:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>my-cdr <span style="color: #BFEBBF;">(</span>my-cons 1 2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #BFEBBF;">(</span>my-cons 1 2<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>p q<span style="color: #D0BF8F;">)</span> q<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>m<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>m 1 2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>p q<span style="color: #D0BF8F;">)</span> q<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>p q<span style="color: #D0BF8F;">)</span> q<span style="color: #BFEBBF;">)</span> 1 2<span style="color: #DCDCCC;">)</span>
2
</pre>
</div>
</div>
</div>
<div id="outline-container-org8b60b4d" class="outline-4">
<h4 id="org8b60b4d">Exercise 2.5</h4>
<div class="outline-text-4" id="text-org8b60b4d">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">log-base</span> base value<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>log value<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>log base<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">factor-out</span> factor value<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>remainder value factor<span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>factor-out factor <span style="color: #93E0E3;">(</span>/ value factor<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      value<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-cons</span> x y<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* <span style="color: #D0BF8F;">(</span>my-expt 2 x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>my-expt 3 y<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-car</span> p<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>log-base 2 <span style="color: #D0BF8F;">(</span>factor-out 3 p<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">my-cdr</span> p<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>log-base 3 <span style="color: #D0BF8F;">(</span>factor-out 2 p<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org5a3b8a5" class="outline-4">
<h4 id="org5a3b8a5">Exercise 2.6</h4>
<div class="outline-text-4" id="text-org5a3b8a5">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">zero</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>f<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x<span style="color: #93E0E3;">)</span> x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">add-1</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>f<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>f <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>n f<span style="color: #94BFF3;">)</span> x<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
Expansion:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>add-1 zero<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>f<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>zero f<span style="color: #9FC59F;">)</span> x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>f<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>q<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #8FB28F;">(</span>z<span style="color: #8FB28F;">)</span> z<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> f<span style="color: #9FC59F;">)</span> x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>f<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #94BFF3;">(</span>z<span style="color: #94BFF3;">)</span> z<span style="color: #9FC59F;">)</span> x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>f<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>f<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>add-1 <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>f<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>f x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>f<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>g<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #8FB28F;">(</span>x<span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>g x<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> f<span style="color: #9FC59F;">)</span> x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>f<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #94BFF3;">(</span>x<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>f x<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span> x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>f<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span>f x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">plus</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>f<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>compose <span style="color: #93E0E3;">(</span>a f<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>b f<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org28ea4f4" class="outline-4">
<h4 id="org28ea4f4">Exercise 2.7</h4>
<div class="outline-text-4" id="text-org28ea4f4">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-interval</span> a b<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cons a b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">lower-bound</span> int<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>min <span style="color: #D0BF8F;">(</span>car int<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>cdr int<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">upper-bound</span> int<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>max <span style="color: #D0BF8F;">(</span>car int<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>cdr int<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org229cdef" class="outline-4">
<h4 id="org229cdef">Exercise 2.8</h4>
<div class="outline-text-4" id="text-org229cdef">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sub-interval</span> x y<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-interval <span style="color: #D0BF8F;">(</span>- <span style="color: #93E0E3;">(</span>lower-bound x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>upper-bound y<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
                 <span style="color: #D0BF8F;">(</span>- <span style="color: #93E0E3;">(</span>upper-bound x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>lower-bound y<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org8396d08" class="outline-4">
<h4 id="org8396d08">Exercise 2.9</h4>
<div class="outline-text-4" id="text-org8396d08">
<p>
Let \(x = (a,b)\) and \(y = (c,d)\) be intervals. Then \(width(x) =
\frac{b-a}{2}\) and \(width(y) = \frac{d-c}{2}\). Well: \[width(x+y) =
width((a+c,b+d))\] \[= \frac{b+d-a-c}{2}\] \[= \frac{b-a}{2} +
\frac{d-c}{2}\] \[= width(x)+width(y)\] And: \[width(x-y) =
width((a-d,b-c))\] \[= \frac{b-c-a+d}{2}\] \[= width(x) + width(y)\]
Now let \(x_{1} = (1,2)\), \(x_{2} = (3,4)\), and \(x_{3} = (5,6)\). Then
\[width(x_{1}) = width(x_{2}) = width(x_{3}) = \frac{1}{2}\] But
\(width(x_{1}*x_{2}) = width((3,8)) = \frac{5}{2}\) and
\(width(x_{2}*x_{3}) = width(15 24) = \frac{9}{2}\). If product width
were a function only of factor widths then \(width(x_{1}*x_{2})\) would
equal \(width(x_{2}*x_{3})\) (because \(width(x_{1}) = width(x_{2}) =
width(x_{3})\)) but this is not the case. Similarly,
\[width(\frac{x_{1}}{x_{2}}) = width((\frac{1}{4},\frac{2}{3})) =
\frac{5}{24}\] \[\neq width(\frac{x_{2}}{x_{3}}) =
width((\frac{1}{3},\frac{4}{5})) = \frac{7}{30}\]
</p>
</div>
</div>
<div id="outline-container-orgee962c1" class="outline-4">
<h4 id="orgee962c1">Exercise 2.10</h4>
<div class="outline-text-4" id="text-orgee962c1">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">width-interval</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>- <span style="color: #93E0E3;">(</span>upper-bound x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>lower-bound x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> 2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">mul-interval</span> x y<span style="color: #BFEBBF;">)</span>
       <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>p1 <span style="color: #9FC59F;">(</span>* <span style="color: #94BFF3;">(</span>lower-bound x<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>lower-bound y<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
             <span style="color: #93E0E3;">(</span>p2 <span style="color: #9FC59F;">(</span>* <span style="color: #94BFF3;">(</span>lower-bound x<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>upper-bound y<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
             <span style="color: #93E0E3;">(</span>p3 <span style="color: #9FC59F;">(</span>* <span style="color: #94BFF3;">(</span>upper-bound x<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>lower-bound y<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
             <span style="color: #93E0E3;">(</span>p4 <span style="color: #9FC59F;">(</span>* <span style="color: #94BFF3;">(</span>upper-bound x<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>upper-bound y<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
         <span style="color: #D0BF8F;">(</span>make-interval <span style="color: #93E0E3;">(</span>min p1 p2 p3 p4<span style="color: #93E0E3;">)</span>
                        <span style="color: #93E0E3;">(</span>max p1 p2 p3 p4<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">div-interval</span> x y<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>width-interval y<span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>error <span style="color: #CC9393;">"Division by zero-width interval"</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>mul-interval x
      <span style="color: #93E0E3;">(</span>make-interval <span style="color: #9FC59F;">(</span>/ 1.0 <span style="color: #94BFF3;">(</span>upper-bound y<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
      <span style="color: #9FC59F;">(</span>/ 1.0 <span style="color: #94BFF3;">(</span>lower-bound y<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org555c05e" class="outline-4">
<h4 id="org555c05e">Exercise 2.11</h4>
<div class="outline-text-4" id="text-org555c05e">
<p>
If we're multiplying intervals \(i=(a,b)\) and \(j=(x,y)\) then we must have \(a \leq
b\) and \(x \leq y\) and so we have the following cases:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">\(a \leq b < 0\)</th>
<th scope="col" class="org-left">\(a < 0 \leq b\)</th>
<th scope="col" class="org-left">\(0 \leq a \leq b\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(x \leq y < 0\)</td>
<td class="org-left">\((by,ax)\)</td>
<td class="org-left">\((bx,ax)\)</td>
<td class="org-left">\((bx,ay)\)</td>
</tr>

<tr>
<td class="org-left">\(x < 0 \leq y\)</td>
<td class="org-left">\((ay,ax)\)</td>
<td class="org-left">\((min(ay,bx),min(ax,by))\)</td>
<td class="org-left">\((bx,by)\)</td>
</tr>

<tr>
<td class="org-left">\(0 \leq x \leq y\)</td>
<td class="org-left">\((ay,bx)\)</td>
<td class="org-left">\((ay,by)\)</td>
<td class="org-left">\((ax,by)\)</td>
</tr>
</tbody>
</table>
<p>
For simplicity's sake, we notice that multiplication is commutative
and simplify our table:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-left">\(a \leq b < 0\)</th>
<th scope="col" class="org-left">\(a < 0 \leq b\)</th>
<th scope="col" class="org-left">\(0 \leq a \leq b\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">\(x \leq y < 0\)</td>
<td class="org-left">\((by,ax)\)</td>
<td class="org-left">\((bx,ax)\)</td>
<td class="org-left">\((bx,ay)\)</td>
</tr>

<tr>
<td class="org-left">\(x < 0 \leq y\)</td>
<td class="org-left">\(j*i\)</td>
<td class="org-left">\((min(ay,bx),min(ax,by))\)</td>
<td class="org-left">\((bx,by)\)</td>
</tr>

<tr>
<td class="org-left">\(0 \leq x \leq y\)</td>
<td class="org-left">\(j*i\)</td>
<td class="org-left">\(j*i\)</td>
<td class="org-left">\((ax,by)\)</td>
</tr>
</tbody>
</table>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">mul-interval</span> i j<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>a <span style="color: #9FC59F;">(</span>lower-bound i<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>b <span style="color: #9FC59F;">(</span>upper-bound i<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>x <span style="color: #9FC59F;">(</span>lower-bound j<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>y <span style="color: #9FC59F;">(</span>upper-bound j<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>&lt; b 0<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>&lt; y 0<span style="color: #94BFF3;">)</span>
                       <span style="color: #94BFF3;">(</span>make-interval <span style="color: #E0CF9F;">(</span>* b y<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>* a x<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                       <span style="color: #94BFF3;">(</span>mul-interval j i<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>&lt; a 0<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>&lt; y 0<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>make-interval <span style="color: #8FB28F;">(</span>* b x<span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>* a x<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                         <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>&lt; x 0<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>make-interval <span style="color: #8FB28F;">(</span>min <span style="color: #6CA0A3;">(</span>* a y<span style="color: #6CA0A3;">)</span> <span style="color: #6CA0A3;">(</span>* b x<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                                                 <span style="color: #8FB28F;">(</span>max <span style="color: #6CA0A3;">(</span>* a x<span style="color: #6CA0A3;">)</span> <span style="color: #6CA0A3;">(</span>* b y<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                         <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #E0CF9F;">(</span>mul-interval j i<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>&lt; y 0<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>make-interval <span style="color: #8FB28F;">(</span>* b x<span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>* a y<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                      <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>&lt; x 0<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>make-interval <span style="color: #8FB28F;">(</span>* b x<span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>* b y<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                      <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #E0CF9F;">(</span>make-interval <span style="color: #8FB28F;">(</span>* a x<span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>* b y<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org247478b" class="outline-4">
<h4 id="org247478b">Exercise 2.12</h4>
<div class="outline-text-4" id="text-org247478b">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-center-width</span> c w<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-interval <span style="color: #D0BF8F;">(</span>- c w<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>+ c w<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">center</span> i<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>lower-bound i<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>upper-bound i<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> 2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">width</span> i<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>- <span style="color: #93E0E3;">(</span>upper-bound i<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>lower-bound i<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> 2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>  
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-center-percent</span> c p<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-center-width c <span style="color: #D0BF8F;">(</span>* c p<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">percent</span> i<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>width i<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>center i<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4323988" class="outline-4">
<h4 id="org4323988">Exercise 2.13</h4>
<div class="outline-text-4" id="text-org4323988">
<p>
Let interval \(i\) have center \(c_{i}\) and tolerance \(p_{i}\). Let
interval \(j\) have center \(c_{j}\) and tolerance \(p_{j}\). Then \(i =
(c_{i}-c_{i}p_{i},c_{i}+c_{i}p_{i})\) and \(j =
(c_{j}-c_{j}p_{j},c_{j}+c_{j}p_{j})\). Suppose \(c_{i} > 0\) and \(c_{j} >
0\). Then \[i*j =
((c_{i}-c_{i}p_{i})*(c_{j}-c_{j}p_{j}),(c_{i}+c_{i}p_{i})*(c_{j}+c_{j}p_{j}))\]
\[= (c_{i}(1-p_{i})c_{j}(1-p_{j}),c_{i}(1+p_{i})c_{j}(1+p_{j}))\] \[=
(c_{i}c_{j}(1-p_{i})(1-p_{j}),c_{i}c_{j}(1+p_{i})(1+p_{j}))\] Supposing
small percentage tolerances: \[=
(c_{i}c_{j}(1-p_{i}-p_{j}),c_{i}c_{j}(1+p_{i}+p_{j}))\] Therefore \(i*j\)
is an interval centered at \(c_{i}c_{j}\) with tolerance
\(p_{i}+p_{j}\).
</p>
</div>
</div>
<div id="outline-container-orgc83d97e" class="outline-4">
<h4 id="orgc83d97e">Exercise 2.14</h4>
<div class="outline-text-4" id="text-orgc83d97e">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">add-interval</span> x y<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-interval <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>lower-bound x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>lower-bound y<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
                 <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>upper-bound x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>upper-bound y<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">par1</span> r1 r2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>div-interval <span style="color: #D0BF8F;">(</span>mul-interval r1 r2<span style="color: #D0BF8F;">)</span>
                <span style="color: #D0BF8F;">(</span>add-interval r1 r2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

  <span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">par2</span> r1 r2<span style="color: #BFEBBF;">)</span>
    <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>one <span style="color: #9FC59F;">(</span>make-interval 1 1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>div-interval one
                    <span style="color: #93E0E3;">(</span>add-interval <span style="color: #9FC59F;">(</span>div-interval one r1<span style="color: #9FC59F;">)</span>
                                  <span style="color: #9FC59F;">(</span>div-interval one r2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
Let \(R_{1} = (a_{1},b_{1})\) and \(R_{2} = (a_{2},b_{2})\). Expanding, we
see: \[\frac{R_{1}R_{2}}{R_{1}+R_{2}} =
(\frac{a_{1}a_{2}}{b_{1}+b_{2}},\frac{b_{1}b_{2}}{a_{1}+a_{2}})\]
\[\frac{1}{\frac{1}{R_{1}}+\frac{1}{R_{2}}} =
(\frac{a_{1}a_{2}}{a_{1}+a_{2}},\frac{b_{1}b_{2}}{b_{1}+b_{2}})\] This
can be verified in the REPL.
</p>
</div>
</div>
</div>
<div id="outline-container-org2a64ba4" class="outline-3">
<h3 id="org2a64ba4">Section 2.2</h3>
<div class="outline-text-3" id="text-org2a64ba4">
</div>
<div id="outline-container-org45882bb" class="outline-4">
<h4 id="org45882bb">Exercise 2.17</h4>
<div class="outline-text-4" id="text-org45882bb">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">last-pair</span> l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? <span style="color: #93E0E3;">(</span>cdr l<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      l
      <span style="color: #D0BF8F;">(</span>last-pair <span style="color: #93E0E3;">(</span>cdr l<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5312d70" class="outline-4">
<h4 id="org5312d70">Exercise 2.18</h4>
<div class="outline-text-4" id="text-org5312d70">
<p>
Note that "nil" is no longer a part of the Scheme standard; we'll use
<kbd>()</kbd> instead. See this <a href="https://stackoverflow.com/questions/9115703/null-value-in-mit-scheme">stackoverflow post</a> for more.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">reverse</span> l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">helper</span> in out<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>null? in<span style="color: #93E0E3;">)</span>
        out
        <span style="color: #93E0E3;">(</span>helper <span style="color: #9FC59F;">(</span>cdr in<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>cons <span style="color: #94BFF3;">(</span>car in<span style="color: #94BFF3;">)</span> out<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>helper l <span style="color: #D0BF8F;">()</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org264fb7b" class="outline-4">
<h4 id="org264fb7b">Exercise 2.19</h4>
<div class="outline-text-4" id="text-org264fb7b">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">no-more?</span> null?<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">except-first-denomination</span> cdr<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">first-denomination</span> car<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cc</span> amount coin-values<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= amount 0<span style="color: #93E0E3;">)</span> 1<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #9FC59F;">(</span>&lt; amount 0<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>no-more? coin-values<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span>
         <span style="color: #93E0E3;">(</span>+ <span style="color: #9FC59F;">(</span>cc amount
                <span style="color: #94BFF3;">(</span>except-first-denomination coin-values<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
            <span style="color: #9FC59F;">(</span>cc <span style="color: #94BFF3;">(</span>- amount
                   <span style="color: #E0CF9F;">(</span>first-denomination coin-values<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                coin-values<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
The order of the list coin-values still does not affect the
output because the procedure does not rely on any assumptions
regarding the order of coin-values.
</p>
</div>
</div>
<div id="outline-container-org9fd410c" class="outline-4">
<h4 id="org9fd410c">Exercise 2.20</h4>
<div class="outline-text-4" id="text-org9fd410c">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">same-parity?</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>remainder a 2<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>remainder b 2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">same-parity</span> x . l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">filterer</span> sublist<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>null? sublist<span style="color: #9FC59F;">)</span> sublist<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>same-parity? x <span style="color: #94BFF3;">(</span>car sublist<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
           <span style="color: #9FC59F;">(</span>cons <span style="color: #94BFF3;">(</span>car sublist<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>filterer <span style="color: #E0CF9F;">(</span>cdr sublist<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>filterer <span style="color: #94BFF3;">(</span>cdr sublist<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cons x <span style="color: #D0BF8F;">(</span>filterer l<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0b31535" class="outline-4">
<h4 id="org0b31535">Exercise 2.21</h4>
<div class="outline-text-4" id="text-org0b31535">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square-list</span> items<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? items<span style="color: #D0BF8F;">)</span>
      items
      <span style="color: #D0BF8F;">(</span>cons <span style="color: #93E0E3;">(</span>square <span style="color: #9FC59F;">(</span>car items<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
            <span style="color: #93E0E3;">(</span>square-list <span style="color: #9FC59F;">(</span>cdr items<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square-list-map</span> items<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> square items<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org60b3dfd" class="outline-4">
<h4 id="org60b3dfd">Exercise 2.22</h4>
<div class="outline-text-4" id="text-org60b3dfd">
<p>
Elements appearing first in the input list will be added to the head
of the ouput list before elements appearing later. Therefore, elements
appearing first in the input will appear later in the output.
</p>

<p>
Now, the output isn't a list.
</p>
</div>
</div>
<div id="outline-container-org5323a89" class="outline-4">
<h4 id="org5323a89">Exercise 2.23</h4>
<div class="outline-text-4" id="text-org5323a89">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">for-each</span> f l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>not <span style="color: #93E0E3;">(</span>null? l<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">begin</span> <span style="color: #93E0E3;">(</span>f <span style="color: #9FC59F;">(</span>car l<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
             <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">for-each</span> f <span style="color: #9FC59F;">(</span>cdr l<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org90e2a81" class="outline-4">
<h4 id="org90e2a81">Exercise 2.25</h4>
<div class="outline-text-4" id="text-org90e2a81">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">l1</span> <span style="color: #BFEBBF;">(</span>list 1 3 <span style="color: #D0BF8F;">(</span>list 5 7<span style="color: #D0BF8F;">)</span> 9<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>car <span style="color: #BFEBBF;">(</span>cdr <span style="color: #D0BF8F;">(</span>car <span style="color: #93E0E3;">(</span>cdr <span style="color: #9FC59F;">(</span>cdr l1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">l2</span> <span style="color: #BFEBBF;">(</span>list <span style="color: #D0BF8F;">(</span>list 7<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>car <span style="color: #BFEBBF;">(</span>car l2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">l3</span> <span style="color: #BFEBBF;">(</span>list 1 <span style="color: #D0BF8F;">(</span>list 2 <span style="color: #93E0E3;">(</span>list 3 <span style="color: #9FC59F;">(</span>list 4 <span style="color: #94BFF3;">(</span>list 5 <span style="color: #E0CF9F;">(</span>list 6 7<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>car <span style="color: #BFEBBF;">(</span>cdr <span style="color: #D0BF8F;">(</span>car <span style="color: #93E0E3;">(</span>cdr <span style="color: #9FC59F;">(</span>car <span style="color: #94BFF3;">(</span>cdr <span style="color: #E0CF9F;">(</span>car <span style="color: #8FB28F;">(</span>cdr <span style="color: #6CA0A3;">(</span>car <span style="color: #DCDCCC;">(</span>cdr <span style="color: #BFEBBF;">(</span>car <span style="color: #D0BF8F;">(</span>cdr l3<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org56d4ce3" class="outline-4">
<h4 id="org56d4ce3">Exercise 2.27</h4>
<div class="outline-text-4" id="text-org56d4ce3">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">deep-reverse</span> l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">helper</span> in out<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>null? in<span style="color: #93E0E3;">)</span>
        out
        <span style="color: #93E0E3;">(</span>helper <span style="color: #9FC59F;">(</span>cdr in<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>cons <span style="color: #94BFF3;">(</span>deep-reverse <span style="color: #E0CF9F;">(</span>car in<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> out<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>list? l<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>helper l <span style="color: #93E0E3;">()</span><span style="color: #D0BF8F;">)</span>
      l<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaf060e0" class="outline-4">
<h4 id="orgaf060e0">Exercise 2.28</h4>
<div class="outline-text-4" id="text-orgaf060e0">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fringe</span> tree<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>not <span style="color: #9FC59F;">(</span>list? tree<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>list tree<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>not <span style="color: #9FC59F;">(</span>pair? tree<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> tree<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>append <span style="color: #9FC59F;">(</span>fringe <span style="color: #94BFF3;">(</span>car tree<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>fringe <span style="color: #94BFF3;">(</span>cdr tree<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd6fc44a" class="outline-4">
<h4 id="orgd6fc44a">Exercise 2.29</h4>
<div class="outline-text-4" id="text-orgd6fc44a">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">left-branch</span> m<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car m<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">right-branch</span> m<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car <span style="color: #D0BF8F;">(</span>cdr m<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">branch-length</span> b<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">branch-structure</span> b<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car <span style="color: #D0BF8F;">(</span>cdr b<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">mobile?</span> structure<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>pair? structure<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">branch-weight</span> b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>structure <span style="color: #9FC59F;">(</span>branch-structure b<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>mobile? structure<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>total-weight structure<span style="color: #93E0E3;">)</span>
        structure<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>   
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">total-weight</span> m<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>+ <span style="color: #D0BF8F;">(</span>branch-weight <span style="color: #93E0E3;">(</span>left-branch m<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
     <span style="color: #D0BF8F;">(</span>branch-weight <span style="color: #93E0E3;">(</span>right-branch m<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">mobile-balanced?</span> m<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">branch-balanced?</span> b<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>structure <span style="color: #94BFF3;">(</span>branch-structure b<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>mobile? structure<span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>mobile-balanced? structure<span style="color: #9FC59F;">)</span>
          #t<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>left <span style="color: #9FC59F;">(</span>left-branch m<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>right <span style="color: #9FC59F;">(</span>right-branch m<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #93E0E3;">(</span>= <span style="color: #9FC59F;">(</span>* <span style="color: #94BFF3;">(</span>branch-length left<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>branch-weight left<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
            <span style="color: #9FC59F;">(</span>* <span style="color: #94BFF3;">(</span>branch-length right<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>branch-weight right<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>branch-balanced? left<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>branch-balanced? right<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5a8ea68" class="outline-4">
<h4 id="org5a8ea68">Exercise 2.30</h4>
<div class="outline-text-4" id="text-org5a8ea68">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square-tree</span> tree<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? tree<span style="color: #93E0E3;">)</span> tree<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>not <span style="color: #9FC59F;">(</span>pair? tree<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>square tree<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>cons <span style="color: #9FC59F;">(</span>square-tree <span style="color: #94BFF3;">(</span>car tree<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
                    <span style="color: #9FC59F;">(</span>square-tree <span style="color: #94BFF3;">(</span>cdr tree<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square-tree-map</span> tree<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>subtree<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>not <span style="color: #94BFF3;">(</span>pair? subtree<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>square subtree<span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>square-tree-map subtree<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
       tree<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7231783" class="outline-4">
<h4 id="org7231783">Exercise 2.31</h4>
<div class="outline-text-4" id="text-org7231783">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">tree-map</span> f t<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? t<span style="color: #93E0E3;">)</span> t<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>not <span style="color: #9FC59F;">(</span>pair? t<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>f t<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>cons <span style="color: #9FC59F;">(</span>tree-map f <span style="color: #94BFF3;">(</span>car t<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
                    <span style="color: #9FC59F;">(</span>tree-map f <span style="color: #94BFF3;">(</span>cdr t<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org16a8ccd" class="outline-4">
<h4 id="org16a8ccd">Exercise 2.32</h4>
<div class="outline-text-4" id="text-org16a8ccd">
<p>
The procedure takes advantage of the following observation. If \(x\) is
an element of set \(S\) then we can partition the subsets of \(S\) into
two categories: those that contain \(x\) and those that do not. All of
the subsets that do not contain \(x\) can be found by recursively
finding all of the subsets of \(S \setminus {x}\). All of the subsets
that do contain \(x\) are of the form \(x \cup U\) where \(U \in \wp (S
\setminus {x})\).
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">subsets</span> s<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? s<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>list <span style="color: #93E0E3;">()</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>rest <span style="color: #94BFF3;">(</span>subsets <span style="color: #E0CF9F;">(</span>cdr s<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>append rest <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>l<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>cons <span style="color: #8FB28F;">(</span>car s<span style="color: #8FB28F;">)</span> l<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> rest<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4753d39" class="outline-4">
<h4 id="org4753d39">Exercise 2.33</h4>
<div class="outline-text-4" id="text-org4753d39">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">accumulate</span> op initial sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? sequence<span style="color: #D0BF8F;">)</span>
      initial
      <span style="color: #D0BF8F;">(</span>op <span style="color: #93E0E3;">(</span>car sequence<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span>accumulate op initial <span style="color: #9FC59F;">(</span>cdr sequence<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">map</span> p sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x y<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cons <span style="color: #9FC59F;">(</span>p x<span style="color: #9FC59F;">)</span> y<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">()</span> sequence<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">append</span> seq1 seq2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate cons seq2 seq1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">length</span> sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x y<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>+ 1 y<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> 0 sequence<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3ab1d76" class="outline-4">
<h4 id="org3ab1d76">Exercise 2.34</h4>
<div class="outline-text-4" id="text-org3ab1d76">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">horner-eval</span> x coefficient-sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>this-coeff higher-terms<span style="color: #93E0E3;">)</span>
                <span style="color: #93E0E3;">(</span>+ <span style="color: #9FC59F;">(</span>* higher-terms x<span style="color: #9FC59F;">)</span>
                   this-coeff<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
              0
              coefficient-sequence<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgad11e42" class="outline-4">
<h4 id="orgad11e42">Exercise 2.35</h4>
<div class="outline-text-4" id="text-orgad11e42">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">count-leaves</span> t<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate +
              0
              <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #9FC59F;">(</span>elt<span style="color: #9FC59F;">)</span>
                     <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>pair? elt<span style="color: #94BFF3;">)</span>
                         <span style="color: #94BFF3;">(</span>count-leaves elt<span style="color: #94BFF3;">)</span>
                         1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
                   t<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdf1653b" class="outline-4">
<h4 id="orgdf1653b">Exercise 2.36</h4>
<div class="outline-text-4" id="text-orgdf1653b">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">accumulate-n</span> op init seqs<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? <span style="color: #93E0E3;">(</span>car seqs<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">()</span>
      <span style="color: #D0BF8F;">(</span>cons <span style="color: #93E0E3;">(</span>accumulate op init <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> car seqs<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
            <span style="color: #93E0E3;">(</span>accumulate-n op init <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> cdr seqs<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5dc61c1" class="outline-4">
<h4 id="org5dc61c1">Exercise 2.37</h4>
<div class="outline-text-4" id="text-org5dc61c1">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">dot-product</span> v w<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate + 0 <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> * v w<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">matrix-*-vector</span> m v<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>row<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>dot-product row v<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
       m<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">transpose</span> mat<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate-n cons <span style="color: #D0BF8F;">()</span> mat<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">matrix-*-matrix</span> m n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>cols <span style="color: #9FC59F;">(</span>transpose n<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #9FC59F;">(</span>row<span style="color: #9FC59F;">)</span>
           <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>col<span style="color: #E0CF9F;">)</span>
                  <span style="color: #E0CF9F;">(</span>dot-product row col<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                cols<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         m<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7914ad3" class="outline-4">
<h4 id="org7914ad3">Exercise 2.38</h4>
<div class="outline-text-4" id="text-org7914ad3">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fold-left</span> op initial sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> result rest<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>null? rest<span style="color: #93E0E3;">)</span>
        result
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>op result <span style="color: #94BFF3;">(</span>car rest<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
              <span style="color: #9FC59F;">(</span>cdr rest<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter initial sequence<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">fold-right</span> accumulate<span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>fold-right / 1 <span style="color: #BFEBBF;">(</span>list 1 2 3<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">3/2</span>
<span style="color: #DCDCCC;">(</span>fold-left / 1 <span style="color: #BFEBBF;">(</span>list 1 2 3<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">1/6</span>
<span style="color: #DCDCCC;">(</span>fold-right list <span style="color: #BFEBBF;">()</span> <span style="color: #BFEBBF;">(</span>list 1 2 3<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">(1 (2 (3 ())))</span>
<span style="color: #DCDCCC;">(</span>fold-left list <span style="color: #BFEBBF;">()</span> <span style="color: #BFEBBF;">(</span>list 1 2 3<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span> <span style="color: #5F7F5F;">; </span><span style="color: #7F9F7F;">(((() 1) 2) 3)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgeb2f9ca" class="outline-4">
<h4 id="orgeb2f9ca">Exercise 2.39</h4>
<div class="outline-text-4" id="text-orgeb2f9ca">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">reverse</span> sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fold-right <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x y<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>append y <span style="color: #9FC59F;">(</span>list x<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">()</span> sequence<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">reverse</span> sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fold-left <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x y<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cons y x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">()</span> sequence<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga0162c2" class="outline-4">
<h4 id="orga0162c2">Exercise 2.40</h4>
<div class="outline-text-4" id="text-orga0162c2">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">enumerate-interval</span> k<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> curr result<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= curr 0<span style="color: #93E0E3;">)</span>
        result
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>- curr 1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>cons curr result<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter k <span style="color: #D0BF8F;">()</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">unique-pairs</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>flatmap <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>i<span style="color: #93E0E3;">)</span>
             <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #94BFF3;">(</span>j<span style="color: #94BFF3;">)</span>
                    <span style="color: #94BFF3;">(</span>list i j<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
                  <span style="color: #9FC59F;">(</span>enumerate-interval <span style="color: #94BFF3;">(</span>- i 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
           <span style="color: #D0BF8F;">(</span>enumerate-interval n<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org60c9fdd" class="outline-4">
<h4 id="org60c9fdd">Exercise 2.41</h4>
<div class="outline-text-4" id="text-org60c9fdd">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">This is slow...</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">unique-tuples</span> n max<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= n 0<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>list <span style="color: #9FC59F;">()</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>&lt; max n<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">()</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= max n<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>list <span style="color: #9FC59F;">(</span>reverse <span style="color: #94BFF3;">(</span>enumerate-interval n<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>append <span style="color: #9FC59F;">(</span>unique-tuples n <span style="color: #94BFF3;">(</span>- max 1<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
                      <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>t<span style="color: #E0CF9F;">)</span>
                             <span style="color: #E0CF9F;">(</span>cons max t<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                           <span style="color: #94BFF3;">(</span>unique-tuples <span style="color: #E0CF9F;">(</span>- n 1<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>- max 1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(define (unique-tuples n max)</span>
<span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(define (iter tuples)</span>
<span style="color: #5F7F5F;">;;     </span><span style="color: #7F9F7F;">(if (= (length (car tuples)) 0)</span>
<span style="color: #5F7F5F;">;;         </span><span style="color: #7F9F7F;">tuples</span>
<span style="color: #5F7F5F;">;;         </span><span style="color: #7F9F7F;">(iter (flatmap (lambda (l)</span>
<span style="color: #5F7F5F;">;;                          </span><span style="color: #7F9F7F;">(if))))))</span>
<span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(if (&lt; max n)</span>
<span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">()</span>
<span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">(flatmap values</span>
<span style="color: #5F7F5F;">;;                </span><span style="color: #7F9F7F;">(iter (map list</span>
<span style="color: #5F7F5F;">;;                           </span><span style="color: #7F9F7F;">(reverse (enumerate-interval n)))))))</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">;; And this doesn't work...</span>
<span style="color: #5F7F5F;">;; </span><span style="color: #7F9F7F;">(define (unique-tuples n max)</span>
<span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(define (next-tuple tuple)</span>
<span style="color: #5F7F5F;">;;     </span><span style="color: #7F9F7F;">(define (cons-next-tuple min t)</span>
<span style="color: #5F7F5F;">;;       </span><span style="color: #7F9F7F;">(cond ((null? t) t)</span>
<span style="color: #5F7F5F;">;;             </span><span style="color: #7F9F7F;">((null? (cdr t)) t)</span>
<span style="color: #5F7F5F;">;;             </span><span style="color: #7F9F7F;">((= (car t) (- (cadr t) 1))</span>
<span style="color: #5F7F5F;">;;              </span><span style="color: #7F9F7F;">(cons min (cons-next-tuple (+ min 1) (cdr t))))</span>
<span style="color: #5F7F5F;">;;             </span><span style="color: #7F9F7F;">(else (cons (+ 1 (car t)) (cdr t)))))</span>
<span style="color: #5F7F5F;">;;     </span><span style="color: #7F9F7F;">(cons-next-tuple 1 tuple))</span>
<span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(define (iter t result)</span>
<span style="color: #5F7F5F;">;;     </span><span style="color: #7F9F7F;">(if (&gt; (car t) max)</span>
<span style="color: #5F7F5F;">;;         </span><span style="color: #7F9F7F;">result</span>
<span style="color: #5F7F5F;">;;         </span><span style="color: #7F9F7F;">(iter (next-tuple t) (cons t result))))</span>
<span style="color: #5F7F5F;">;;   </span><span style="color: #7F9F7F;">(iter (enumerate-interval n) ()))</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum-list</span> l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fold-left + 0 l<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">bounded-partition</span> n parts bound<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>filter <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>t<span style="color: #93E0E3;">)</span>
            <span style="color: #93E0E3;">(</span>= n <span style="color: #9FC59F;">(</span>sum-list t<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
          <span style="color: #D0BF8F;">(</span>unique-tuples parts bound<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">bounded-paritition-3</span> total bound<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>bounded-partition total 3 bound<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb7f7a93" class="outline-4">
<h4 id="orgb7f7a93">Exercise 2.42</h4>
<div class="outline-text-4" id="text-orgb7f7a93">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-queen</span> row col<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>list row col<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">get-row</span> queen<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>car queen<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">get-col</span> queen<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cadr queen<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">queens</span> board-size<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">adjoin-position</span> row col board<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>cons <span style="color: #93E0E3;">(</span>make-queen row col<span style="color: #93E0E3;">)</span> board<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">safe?</span> col board<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">(</span><span style="color: #93E0E3;">same-diag?</span> q1 q2<span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span>= <span style="color: #9FC59F;">(</span>difference <span style="color: #94BFF3;">(</span>get-row q1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>get-row q2<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
         <span style="color: #9FC59F;">(</span>difference <span style="color: #94BFF3;">(</span>get-col q1<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>get-col q2<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">(</span><span style="color: #93E0E3;">same-row?</span> q1 q2<span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span>= <span style="color: #9FC59F;">(</span>get-row q1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>get-row q2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>new-queen <span style="color: #94BFF3;">(</span>car board<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span>fold-right <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #94BFF3;">(</span>x y<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> x y<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
                  #t
                  <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>q<span style="color: #E0CF9F;">)</span>
                         <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #8FB28F;">(</span>not <span style="color: #6CA0A3;">(</span>same-row? new-queen q<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                              <span style="color: #8FB28F;">(</span>not <span style="color: #6CA0A3;">(</span>same-diag? new-queen q<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                       <span style="color: #94BFF3;">(</span>cdr board<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">empty-board</span> <span style="color: #D0BF8F;">()</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">queen-cols</span> k<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= k 0<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>list empty-board<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>filter
         <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #94BFF3;">(</span>positions<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>safe? k positions<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
         <span style="color: #9FC59F;">(</span>flatmap
          <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>rest-of-queens<span style="color: #E0CF9F;">)</span>
            <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #8FB28F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #6CA0A3;">(</span>new-row<span style="color: #6CA0A3;">)</span>
                   <span style="color: #6CA0A3;">(</span>adjoin-position new-row k rest-of-queens<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                 <span style="color: #8FB28F;">(</span>enumerate-interval board-size<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
          <span style="color: #94BFF3;">(</span>queen-cols <span style="color: #E0CF9F;">(</span>- k 1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>queen-cols board-size<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">repeat-display</span> n str<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&gt; n 0<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">begin</span>
        <span style="color: #93E0E3;">(</span>display str<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>whitespace <span style="color: #9FC59F;">(</span>- n 1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">print-queens</span> board<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> left<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>not <span style="color: #9FC59F;">(</span>null? left<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>row <span style="color: #E0CF9F;">(</span>get-row <span style="color: #8FB28F;">(</span>car left<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>repeat-display <span style="color: #94BFF3;">(</span>- row 1<span style="color: #94BFF3;">)</span> <span style="color: #CC9393;">"."</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>display <span style="color: #CC9393;">"Q"</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>repeat-display <span style="color: #94BFF3;">(</span>- <span style="color: #E0CF9F;">(</span>length board<span style="color: #E0CF9F;">)</span> row<span style="color: #94BFF3;">)</span> <span style="color: #CC9393;">"."</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>newline<span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>iter <span style="color: #94BFF3;">(</span>cdr left<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter board<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">show-queens</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>soln<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>print-queens soln<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>newline<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
       <span style="color: #D0BF8F;">(</span>queens n<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc1430d4" class="outline-4">
<h4 id="orgc1430d4">Exercise 2.43</h4>
<div class="outline-text-4" id="text-orgc1430d4">
<p>
In the provided <kbd>queens</kbd> procedure, the \(n \times (k-1)\) subproblem is
solved once. Then, for each solution of the subproblem, several
candidate solutions for the \(n \times k\) problem are created by adding
a new column with a queen in each possible row.
</p>

<p>
Louis's procedure calculates each possible row once (in the call to
<kbd>enumerate-interval</kbd>). Then, for each row, the procedure calculates
the \(n \times (k-1)\) subproblem. So, at each level of the process, the
subproblem is solved \(n\) times. Therefore, in Louis' procedure, the
base-case \(n \times 0\) problem, computed by <kbd>(queens 0)</kbd>, is
calculated \(n^{n}\) times. Louis' procedure solves the puzzle in
approximately time \(n^{n}T\).
</p>
</div>
</div>
<div id="outline-container-orga0a3945" class="outline-4">
<h4 id="orga0a3945">Exercise 2.44</h4>
<div class="outline-text-4" id="text-orga0a3945">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">up-split</span> painter n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= n 0<span style="color: #D0BF8F;">)</span>
      painter
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>smaller <span style="color: #94BFF3;">(</span>up-split painter <span style="color: #E0CF9F;">(</span>- n 1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>below painter <span style="color: #9FC59F;">(</span>beside smaller smaller<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org01ecff8" class="outline-4">
<h4 id="org01ecff8">Exercise 2.45</h4>
<div class="outline-text-4" id="text-org01ecff8">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">split</span> outer inner<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>painter n<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= n 0<span style="color: #93E0E3;">)</span>
        painter
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>smaller <span style="color: #E0CF9F;">(</span><span style="color: #8FB28F;">(</span>split outer inner<span style="color: #8FB28F;">)</span> painter <span style="color: #8FB28F;">(</span>- n 1<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>outer painter <span style="color: #94BFF3;">(</span>inner smaller smaller<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org48a3b61" class="outline-4">
<h4 id="org48a3b61">Exercise 2.46</h4>
<div class="outline-text-4" id="text-org48a3b61">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-vect</span> x y<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cons x y<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">xcor-vect</span> v<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car v<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">ycor-vect</span> v<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cdr v<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">add-vect</span> v1 v2<span style="color: #BFEBBF;">)</span> <span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
I'll leave this exercise here.
</p>
</div>
</div>
<div id="outline-container-org339d705" class="outline-4">
<h4 id="org339d705">Exercise 2.47</h4>
<div class="outline-text-4" id="text-org339d705">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-frame</span> origin edge1 edge2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>list origin edge1 edge2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">origin-frame</span> frame<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>car frame<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">edge1-frame</span> frame<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cadr frame<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">edge2-frame</span> frame<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>caddr frame<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-frame</span> origin edge1 edge2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cons origin <span style="color: #D0BF8F;">(</span>cons edge1 edge2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">origin-frame</span> frame<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>car frame<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">edge1-frame</span> frame<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cadr frame<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">edge2-frames</span> frame<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cddr frame<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf4e85d0" class="outline-4">
<h4 id="orgf4e85d0">Exercise 2.48</h4>
<div class="outline-text-4" id="text-orgf4e85d0">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-segment</span> v1 v2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cons v1 v2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">start-segment</span> v<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car v<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">end-segment</span> v<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cdr v<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2978a93" class="outline-4">
<h4 id="org2978a93">Exercise 2.49</h4>
<div class="outline-text-4" id="text-org2978a93">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fold-right</span> op null l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? l<span style="color: #D0BF8F;">)</span>
      null
      <span style="color: #D0BF8F;">(</span>op <span style="color: #93E0E3;">(</span>car l<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>fold-right op null <span style="color: #9FC59F;">(</span>cdr l<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fold-left-iter</span> op null l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> curr result<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>null? curr<span style="color: #93E0E3;">)</span>
        result
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>cdr curr<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>op result <span style="color: #94BFF3;">(</span>car curr<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter l null<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">take</span> n l<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= n 0<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">()</span>
      <span style="color: #D0BF8F;">(</span>cons <span style="color: #93E0E3;">(</span>car l<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>take <span style="color: #9FC59F;">(</span>- n 1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>cdr l<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">rotate-left</span> l n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fold-right cons
              <span style="color: #D0BF8F;">(</span>take n l<span style="color: #D0BF8F;">)</span>
              <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>repeated cdr n<span style="color: #93E0E3;">)</span> l<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">outline</span> f<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>segments-&gt;painter
   <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>rotl <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>l<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>fold-right cons <span style="color: #8FB28F;">(</span>list <span style="color: #6CA0A3;">(</span>car l<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>cdr l<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
     <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>x-cors <span style="color: #E0CF9F;">(</span>list 0 0 1 1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
       <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>corners <span style="color: #8FB28F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> make-vect x-cors <span style="color: #6CA0A3;">(</span>rotl x-cors<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
         <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> make-segment
              corners
              <span style="color: #E0CF9F;">(</span>rotl corners<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">x-painter</span> f<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>segments-painter
   <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> make-segment
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> make-vect
             <span style="color: #9FC59F;">(</span>list 0 0<span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>list 0 1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> make-vect
             <span style="color: #9FC59F;">(</span>list 1 1<span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>list 1 0<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3bc60ce" class="outline-4">
<h4 id="org3bc60ce">Exercise 2.51</h4>
<div class="outline-text-4" id="text-org3bc60ce">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">below</span> p1 p2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>rotate90 <span style="color: #D0BF8F;">(</span>beside <span style="color: #93E0E3;">(</span>rotate270 p2<span style="color: #93E0E3;">)</span>
                    <span style="color: #93E0E3;">(</span>rotate270 p1<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org33ff3aa" class="outline-3">
<h3 id="org33ff3aa">Section 2.3</h3>
<div class="outline-text-3" id="text-org33ff3aa">
</div>
<div id="outline-container-org1150912" class="outline-4">
<h4 id="org1150912">Exercise 2.53</h4>
<div class="outline-text-4" id="text-org1150912">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>list 'a 'b 'c<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>list <span style="color: #BFEBBF;">(</span>list 'george<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>cdr '<span style="color: #BFEBBF;">(</span><span style="color: #D0BF8F;">(</span>x1 x2<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>y1 y2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>cadr '<span style="color: #BFEBBF;">(</span><span style="color: #D0BF8F;">(</span>x1 x2<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>y1 y2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>pair? <span style="color: #BFEBBF;">(</span>car '<span style="color: #D0BF8F;">(</span>a short list<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>memq 'red '<span style="color: #BFEBBF;">(</span><span style="color: #D0BF8F;">(</span>red shoes<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>blue socks<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>memq 'red '<span style="color: #BFEBBF;">(</span>red shoes blue socks<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1db27ba" class="outline-4">
<h4 id="org1db27ba">Exercise 2.54</h4>
<div class="outline-text-4" id="text-org1db27ba">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">equal?</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #93E0E3;">(</span>pair? a<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>pair? b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #93E0E3;">(</span>equal? <span style="color: #9FC59F;">(</span>car a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>car b<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
           <span style="color: #93E0E3;">(</span>equal? <span style="color: #9FC59F;">(</span>cdr a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>cdr b<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>eq? a b<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbad9df6" class="outline-4">
<h4 id="orgbad9df6">Exercise 2.55</h4>
<div class="outline-text-4" id="text-orgbad9df6">
<p>
Eva types <kbd>(car ''abracadabra)</kbd> and the interpreter prints
<kbd>quote</kbd>. A footnote mentions that <kbd>'</kbd> is implemented as procedure
application, and so <kbd>(car ''abracadabra)</kbd> is evaluated to <kbd>(car (quote
(quote abracadabra)))</kbd>. Then it makes sense for <kbd>car</kbd> of <kbd>(quote
abracadabra)</kbd> to be <kbd>quote</kbd>. To verify this we run the following:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>cdr ''abracadabra<span style="color: #DCDCCC;">)</span>
abracadabra
</pre>
</div>
<p>
This is consistent with our explanation.
</p>
</div>
</div>
<div id="outline-container-org23c9833" class="outline-4">
<h4 id="org23c9833">Exercise 2.56</h4>
<div class="outline-text-4" id="text-org23c9833">
<p>
The provided code:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">same-variable?</span> v1 v2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>variable? v1<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>variable? v2<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>eq? v1 v2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-sum</span> a1 a2<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>list '+ a1 a2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-product</span> m1 m2<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>list '* m1 m2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum?</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>pair? x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>eq? <span style="color: #93E0E3;">(</span>car x<span style="color: #93E0E3;">)</span> '+<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">addend</span> s<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cadr s<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">augend</span> s<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>caddr s<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">product?</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>pair? x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>eq? <span style="color: #93E0E3;">(</span>car x<span style="color: #93E0E3;">)</span> '*<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">multiplier</span> p<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cadr p<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">multiplicand</span> p<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>caddr p<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">deriv</span> exp var<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>number? exp<span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>variable? exp<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>same-variable? exp var<span style="color: #9FC59F;">)</span> 1 0<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>sum? exp<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>make-sum <span style="color: #9FC59F;">(</span>deriv <span style="color: #94BFF3;">(</span>addend exp<span style="color: #94BFF3;">)</span> var<span style="color: #9FC59F;">)</span>
                   <span style="color: #9FC59F;">(</span>deriv <span style="color: #94BFF3;">(</span>augend exp<span style="color: #94BFF3;">)</span> var<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>product? exp<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>make-sum
          <span style="color: #9FC59F;">(</span>make-product <span style="color: #94BFF3;">(</span>multiplier exp<span style="color: #94BFF3;">)</span>
                        <span style="color: #94BFF3;">(</span>deriv <span style="color: #E0CF9F;">(</span>multiplicand exp<span style="color: #E0CF9F;">)</span> var<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>make-product <span style="color: #94BFF3;">(</span>deriv <span style="color: #E0CF9F;">(</span>multiplier exp<span style="color: #E0CF9F;">)</span> var<span style="color: #94BFF3;">)</span>
                        <span style="color: #94BFF3;">(</span>multiplicand exp<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span>
         <span style="color: #93E0E3;">(</span>error <span style="color: #CC9393;">"unknown expression type -- DERIV"</span> exp<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">exponentiation?</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>pair? x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>eq? <span style="color: #93E0E3;">(</span>car x<span style="color: #93E0E3;">)</span> '**<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">base</span> e<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cadr e<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">exponent</span> e<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>caddr e<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-exponentiation</span> b p<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>=number? p 0<span style="color: #93E0E3;">)</span> 1<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>=number? p 1<span style="color: #93E0E3;">)</span> b<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #9FC59F;">(</span>number? b<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>number? p<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>expt b p<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>list '** b p<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-difference</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-sum a <span style="color: #D0BF8F;">(</span>make-product b -1<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">deriv</span> exp var<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>number? exp<span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>variable? exp<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>same-variable? exp var<span style="color: #9FC59F;">)</span> 1 0<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>sum? exp<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>make-sum <span style="color: #9FC59F;">(</span>deriv <span style="color: #94BFF3;">(</span>addend exp<span style="color: #94BFF3;">)</span> var<span style="color: #9FC59F;">)</span>
                   <span style="color: #9FC59F;">(</span>deriv <span style="color: #94BFF3;">(</span>augend exp<span style="color: #94BFF3;">)</span> var<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>product? exp<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>make-sum
          <span style="color: #9FC59F;">(</span>make-product <span style="color: #94BFF3;">(</span>multiplier exp<span style="color: #94BFF3;">)</span>
                        <span style="color: #94BFF3;">(</span>deriv <span style="color: #E0CF9F;">(</span>multiplicand exp<span style="color: #E0CF9F;">)</span> var<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>make-product <span style="color: #94BFF3;">(</span>deriv <span style="color: #E0CF9F;">(</span>multiplier exp<span style="color: #E0CF9F;">)</span> var<span style="color: #94BFF3;">)</span>
                        <span style="color: #94BFF3;">(</span>multiplicand exp<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>exponentiation? exp<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>make-product
          <span style="color: #9FC59F;">(</span>exponent exp<span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>make-product <span style="color: #94BFF3;">(</span>make-exponentiation
                         <span style="color: #E0CF9F;">(</span>base exp<span style="color: #E0CF9F;">)</span>
                         <span style="color: #E0CF9F;">(</span>make-difference <span style="color: #8FB28F;">(</span>exponent exp<span style="color: #8FB28F;">)</span>
                                          1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                        <span style="color: #94BFF3;">(</span>deriv <span style="color: #E0CF9F;">(</span>base exp<span style="color: #E0CF9F;">)</span> var<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span>
         <span style="color: #93E0E3;">(</span>error <span style="color: #CC9393;">"unknown expression type -- DERIV"</span> exp<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgaeac6be" class="outline-4">
<h4 id="orgaeac6be">Exercise 2.57</h4>
<div class="outline-text-4" id="text-orgaeac6be">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">augend</span> s<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? <span style="color: #93E0E3;">(</span>cdddr s<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>caddr s<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>cons '+ <span style="color: #93E0E3;">(</span>cddr s<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-sum</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>flat <span style="color: #9FC59F;">(</span>flatmap <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>t<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #8FB28F;">(</span>sum? t<span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>cdr t<span style="color: #8FB28F;">)</span> t<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                        <span style="color: #94BFF3;">(</span>list a b<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>sum <span style="color: #9FC59F;">(</span>foldl + 0 <span style="color: #94BFF3;">(</span>filter number? flat<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>rest <span style="color: #9FC59F;">(</span>filter! number? flat<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>null? rest<span style="color: #9FC59F;">)</span> sum<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= sum 0<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>null? <span style="color: #E0CF9F;">(</span>cdr rest<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>car rest<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>cons '+ rest<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>cons '+ <span style="color: #94BFF3;">(</span>cons acc rest<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">multiplicand</span> p<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? <span style="color: #93E0E3;">(</span>cdddr p<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>caddr p<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>cons '* <span style="color: #93E0E3;">(</span>cddr p<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-product</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>flat <span style="color: #9FC59F;">(</span>flatmap <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #E0CF9F;">(</span>t<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #8FB28F;">(</span>sum? t<span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>cdr t<span style="color: #8FB28F;">)</span> t<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                        <span style="color: #94BFF3;">(</span>list a b<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>prod <span style="color: #9FC59F;">(</span>foldl * 1 <span style="color: #94BFF3;">(</span>filter number? flat<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>rest <span style="color: #9FC59F;">(</span>filter! number? flat<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>null? rest<span style="color: #9FC59F;">)</span> prod<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= sum 1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>null? <span style="color: #E0CF9F;">(</span>cdr rest<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>car rest<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>cons '+ rest<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>= sum 0<span style="color: #9FC59F;">)</span> 0<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #9FC59F;">(</span>cons '+ <span style="color: #94BFF3;">(</span>cons acc rest<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
I tried to refactor <kbd>make-sum</kbd> and <kbd>make-product</kbd> into a simpler yet
meaningful-enough function, to no avail. I'll heed the <a href="https://en.wikipedia.org/wiki/Rule_of_three_(computer_programming)">rule of three</a>
for now.
</p>
</div>
</div>
<div id="outline-container-org6a421ff" class="outline-4">
<h4 id="org6a421ff">Exercise 2.58</h4>
<div class="outline-text-4" id="text-org6a421ff">
<ol class="org-ol">
<li><p>
Infix addition:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum?</span> e<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>pair? e<span style="color: #D0BF8F;">)</span>
       <span style="color: #D0BF8F;">(</span>pair? <span style="color: #93E0E3;">(</span>cdr e<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
       <span style="color: #D0BF8F;">(</span>eq? <span style="color: #93E0E3;">(</span>cadr e<span style="color: #93E0E3;">)</span> '+<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">addend</span> s<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cadr s<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">augend</span> s<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>caddr s<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-sum</span> a1 a2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>=number? a1 0<span style="color: #93E0E3;">)</span> a2<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>=number? a2 0<span style="color: #93E0E3;">)</span> a1<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #9FC59F;">(</span>number? a1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>number? a2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>+ a1 a2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>list a1 '+ a2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
The same modifications apply to <kbd>product?</kbd>, <kbd>multiplier</kbd>,
<kbd>multiplicand</kbd>, and <kbd>make-product</kbd>, mutatis mutandis.
</p></li>
<li>Each element in a given list is a number, a variable, a sum, a
product, or a parenthesized expression. If a list has more than one
element, it must by a product or a sum. If the list contains both
<kbd>+</kbd> and <kbd>*</kbd>, such as <kbd>(x + 3 * y)</kbd> then the list represents a sum,
because <kbd>*</kbd> binds tighter than <kbd>+</kbd>. Therefore, if the list contains
even one <kbd>+</kbd> then we can consider the expression to the left of the
first <kbd>+</kbd> the addend and the expression to the right the augend. If
a list that has more than one element is not a sum, then it must be
a product.</li>
</ol>
</div>
</div>
<div id="outline-container-org6808a0b" class="outline-4">
<h4 id="org6808a0b">Exercise 2.59</h4>
<div class="outline-text-4" id="text-org6808a0b">
<p>
Provided code:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">adjoin-set</span> x set<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>element-of-set? x set<span style="color: #D0BF8F;">)</span>
      set
      <span style="color: #D0BF8F;">(</span>cons x set<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">element-of-set?</span> x set<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? set<span style="color: #93E0E3;">)</span> false<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>equal? x <span style="color: #9FC59F;">(</span>car set<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> true<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>element-of-set? x <span style="color: #9FC59F;">(</span>cdr set<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">intersection-set</span> set1 set2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #9FC59F;">(</span>null? set1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>null? set2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> '<span style="color: #93E0E3;">()</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>element-of-set? <span style="color: #9FC59F;">(</span>car set1<span style="color: #9FC59F;">)</span> set2<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>cons <span style="color: #9FC59F;">(</span>car set1<span style="color: #9FC59F;">)</span>
               <span style="color: #9FC59F;">(</span>intersection-set <span style="color: #94BFF3;">(</span>cdr set1<span style="color: #94BFF3;">)</span> set2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>intersection-set <span style="color: #9FC59F;">(</span>cdr set1<span style="color: #9FC59F;">)</span> set2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">union-set</span> set1 set2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? set1<span style="color: #93E0E3;">)</span> set2<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? set2<span style="color: #93E0E3;">)</span> set1<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>adjoin-set <span style="color: #9FC59F;">(</span>car set1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>union-set <span style="color: #94BFF3;">(</span>cdr set1<span style="color: #94BFF3;">)</span> set2<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orged916a5" class="outline-4">
<h4 id="orged916a5">Exercise 2.60</h4>
<div class="outline-text-4" id="text-orged916a5">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">element-of-set?</span> x set<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>memq x set<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">adjoin-set</span> x set<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cons x set<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">union-set</span> set1 set2<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>append set1 set2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">intersection-set</span> set1 set2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>filter <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>element-of-set? x set2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> set1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
<kbd>element-of-set?</kbd> is still an \(O(n)\) operation; there's no getting
around this. But <kbd>adjoin-set</kbd> is now an \(O(1)\) operation, and
<kbd>union-set</kbd>, which is \(O(n^{2})\) in my implementation above, is now
\(O(n)\). <kbd>intersection-set</kbd> is still an \(O(n^{2})\) operation.
</p>
</div>
</div>
<div id="outline-container-orgf0d85f3" class="outline-4">
<h4 id="orgf0d85f3">Exercise 2.61</h4>
<div class="outline-text-4" id="text-orgf0d85f3">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">adjoin-set</span> x set<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? set<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cons x set<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>&gt; x <span style="color: #9FC59F;">(</span>car set<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cons <span style="color: #9FC59F;">(</span>car set<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>adjoin-set x <span style="color: #94BFF3;">(</span>cdr set<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= x <span style="color: #9FC59F;">(</span>car set<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> set<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>cons x set<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc3df2e8" class="outline-4">
<h4 id="orgc3df2e8">Exercise 2.62</h4>
<div class="outline-text-4" id="text-orgc3df2e8">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">union-set</span> set1 set2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? set1<span style="color: #93E0E3;">)</span> set2<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? set2<span style="color: #93E0E3;">)</span> set1<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>x1 <span style="color: #E0CF9F;">(</span>car set1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                    <span style="color: #94BFF3;">(</span>x2 <span style="color: #E0CF9F;">(</span>car set2<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
                <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>= x1 x2<span style="color: #E0CF9F;">)</span>
                       <span style="color: #E0CF9F;">(</span>cons x1 <span style="color: #8FB28F;">(</span>union-set <span style="color: #6CA0A3;">(</span>cdr set1<span style="color: #6CA0A3;">)</span>
                                           <span style="color: #6CA0A3;">(</span>cdr set2<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                      <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>&lt; x1 x2<span style="color: #E0CF9F;">)</span>
                       <span style="color: #E0CF9F;">(</span>cons x1 <span style="color: #8FB28F;">(</span>union-set <span style="color: #6CA0A3;">(</span>cdr set1<span style="color: #6CA0A3;">)</span>
                                           set2<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                      <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>&gt; x1 x2<span style="color: #E0CF9F;">)</span>
                       <span style="color: #E0CF9F;">(</span>cons x2 <span style="color: #8FB28F;">(</span>union-set set1
                                           <span style="color: #6CA0A3;">(</span>cdr set2<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
&lt;s
</p>
</div>
</div>
<div id="outline-container-org8ff9ed6" class="outline-4">
<h4 id="org8ff9ed6">Exercise 2.63</h4>
<div class="outline-text-4" id="text-org8ff9ed6">
<p>
The trees from<a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-16.html#%25_fig_2.16"> Figure 2.16</a>:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">tree-a</span>
  <span style="color: #BFEBBF;">(</span>make-tree
   7
   <span style="color: #D0BF8F;">(</span>make-tree
    3
    <span style="color: #93E0E3;">(</span>make-tree 1 <span style="color: #9FC59F;">()</span> <span style="color: #9FC59F;">()</span><span style="color: #93E0E3;">)</span>
    <span style="color: #93E0E3;">(</span>make-tree 5 <span style="color: #9FC59F;">()</span> <span style="color: #9FC59F;">()</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
   <span style="color: #D0BF8F;">(</span>make-tree
    9
    <span style="color: #93E0E3;">()</span>
    <span style="color: #93E0E3;">(</span>make-tree 11 <span style="color: #9FC59F;">()</span> <span style="color: #9FC59F;">()</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">tree-b</span>
  <span style="color: #BFEBBF;">(</span>make-tree
   3
   <span style="color: #D0BF8F;">(</span>make-tree 1 <span style="color: #93E0E3;">()</span> <span style="color: #93E0E3;">()</span><span style="color: #D0BF8F;">)</span>
   <span style="color: #D0BF8F;">(</span>make-tree
    7
    <span style="color: #93E0E3;">(</span>make-tree 5 <span style="color: #9FC59F;">()</span> <span style="color: #9FC59F;">()</span><span style="color: #93E0E3;">)</span>
    <span style="color: #93E0E3;">(</span>make-tree
     9
     <span style="color: #9FC59F;">()</span>
     <span style="color: #9FC59F;">(</span>make-tree 11 <span style="color: #94BFF3;">()</span> <span style="color: #94BFF3;">()</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">tree-c</span>
  <span style="color: #BFEBBF;">(</span>make-tree
   5
   <span style="color: #D0BF8F;">(</span>make-tree
    3
    <span style="color: #93E0E3;">(</span>make-tree 1 <span style="color: #9FC59F;">()</span> <span style="color: #9FC59F;">()</span><span style="color: #93E0E3;">)</span>
    <span style="color: #93E0E3;">()</span><span style="color: #D0BF8F;">)</span>
   <span style="color: #D0BF8F;">(</span>make-tree
    9
    <span style="color: #93E0E3;">(</span>make-tree 7 <span style="color: #9FC59F;">()</span> <span style="color: #9FC59F;">()</span><span style="color: #93E0E3;">)</span>
    <span style="color: #93E0E3;">(</span>make-tree 11 <span style="color: #9FC59F;">()</span> <span style="color: #9FC59F;">()</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<ol class="org-ol">
<li><kbd>tree-&gt;list-1</kbd> and <kbd>tree-&gt;list-2</kbd> result in <kbd>(1 3 5 7 9 11)</kbd> for
every tree above. Moreover, <kbd>tree-&gt;list-1</kbd> and <kbd>tree-&gt;list-2</kbd>
produce the same result for for any two trees that represent the same
set.</li>
<li><p>
<kbd>tree-&gt;list-1</kbd> uses <kbd>append</kbd> to combine the solutions to the
recursively-solved subproblems. This procedure takes time
proportional to the size of its first input, namely the left
subtree of any given node.
</p>

<p>
Suppose we have a balanced tree of \(n = 2^{k}-1\) nodes (meaning
that \(k\) is the number of levels in the tree). Level \(i\) of the
tree (call the root level \(0\)) has \(2^{i}\) nodes. Each of these
nodes combines its subproblems in time proportional to the size of
its left subtree, which is \(2^{k-i-1}\). The total time of the tree
is therefore proportional to the following: \[\sum_{i=0}^{k-1}
   2^{i}2^{k-i-1} = \sum_{i=0}^{k-1} 2^{k-1} = k2^{k-1} =
   k\frac{n+1}{2} = \log(n+1)\frac{n+1}{2}\] Therefore the order of
growth of <kbd>tree-&gt;list-1</kbd> is \(O(n\log(n))\).
</p>

<p>
Perhaps a simpler formula:
\[\frac{n}{2}+2\frac{n}{4}+4\frac{n}{8}+\ldots\]
\[\frac{n}{2}+\frac{n}{2}+\frac{n}{2}+\ldots\]
\[\log(n)\frac{n}{2}\]
</p>

<p>
On the other hand, <kbd>tree-&gt;list-2</kbd> uses <kbd>cons</kbd> to combine
subproblems, and therefore take \(O(1)\) time for each of the \(n\)
nodes in the tree, for a total of \(O(n)\) time.
</p></li>
</ol>
</div>
</div>
<div id="outline-container-org1b83e1d" class="outline-4">
<h4 id="org1b83e1d">Exercise 2.64</h4>
<div class="outline-text-4" id="text-org1b83e1d">
<ol class="org-ol">
<li><kbd>partial-tree</kbd> recurses once left and once right at each node to
build the tree. Therefore each of the \(n\) elements is tree-ified by
one call to <kbd>partial-tree</kbd>. All of the operations <kbd>partial-tree</kbd>
used to combine the solutions to the subproblems are \(O(1)\),
therefore <kbd>partial-tree</kbd> takes \(O(n)\) time.</li>
</ol>
</div>
</div>
<div id="outline-container-orge27f686" class="outline-4">
<h4 id="orge27f686">Exercise 2.65</h4>
<div class="outline-text-4" id="text-orge27f686">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">union-set</span> set1 set2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>list-&gt;tree <span style="color: #D0BF8F;">(</span>union-set-list <span style="color: #93E0E3;">(</span>tree-&gt;list-2 set1<span style="color: #93E0E3;">)</span>
                              <span style="color: #93E0E3;">(</span>tree-&gt;list-2 set2<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
Mutatis mutandis for <kbd>intersection-set</kbd>.
</p>
</div>
</div>
<div id="outline-container-org3f5f504" class="outline-4">
<h4 id="org3f5f504">Exercise 2.67</h4>
<div class="outline-text-4" id="text-org3f5f504">
<p>
<kbd>(a d a b b c a)</kbd>
</p>
</div>
</div>
<div id="outline-container-org8c63945" class="outline-4">
<h4 id="org8c63945">Exercise 2.68</h4>
<div class="outline-text-4" id="text-org8c63945">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">encode-symbol</span> symbol tree<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">encode-1</span> bits branch<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>leaf? branch<span style="color: #93E0E3;">)</span>
        bits
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>left <span style="color: #E0CF9F;">(</span>left-branch branch<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>memq symbol <span style="color: #E0CF9F;">(</span>symbols left<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span>encode-1 <span style="color: #E0CF9F;">(</span>cons 0 bits<span style="color: #E0CF9F;">)</span> left<span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span>encode-1 <span style="color: #E0CF9F;">(</span>cons 1 bits<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>right-branch branch<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>memq symbol <span style="color: #93E0E3;">(</span>symbols tree<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>reverse <span style="color: #93E0E3;">(</span>encode-1 <span style="color: #9FC59F;">()</span> tree<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>error <span style="color: #CC9393;">"not in tree"</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9958d17" class="outline-4">
<h4 id="org9958d17">Exercise 2.69</h4>
<div class="outline-text-4" id="text-org9958d17">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">successive-merge</span> tree-set<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? tree-set<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">()</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>null? <span style="color: #9FC59F;">(</span>cdr tree-set<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>car tree-set<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span>
         <span style="color: #93E0E3;">(</span>successive-merge <span style="color: #9FC59F;">(</span>adjoin-set <span style="color: #94BFF3;">(</span>make-code-tree <span style="color: #E0CF9F;">(</span>car tree-set<span style="color: #E0CF9F;">)</span>
                                                       <span style="color: #E0CF9F;">(</span>cadr tree-set<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                                       <span style="color: #94BFF3;">(</span>cddr tree-set<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org865ab1c" class="outline-4">
<h4 id="org865ab1c">Exercise 2.70</h4>
<div class="outline-text-4" id="text-org865ab1c">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>length <span style="color: #BFEBBF;">(</span>encode '<span style="color: #D0BF8F;">(</span>GET A JOB
                  SHA NA NA NA NA NA NA NA NA
                  GET A JOB
                  SHA NA NA NA NA NA NA NA NA
                  WAH YIP YIP YIP YIP YIP YIP YIP YIP YIP
                  SHA BOOM<span style="color: #D0BF8F;">)</span>
                <span style="color: #D0BF8F;">(</span>generate-huffman-tree
                 '<span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>A 2<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>NA 16<span style="color: #9FC59F;">)</span>
                   <span style="color: #9FC59F;">(</span>BOOM 1<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>SHA 3<span style="color: #9FC59F;">)</span>
                   <span style="color: #9FC59F;">(</span>GET 2<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>YIP 9<span style="color: #9FC59F;">)</span>
                   <span style="color: #9FC59F;">(</span>JOB 2<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>WAH 1<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #5F7F5F;">;</span><span style="color: #7F9F7F;">Value: 84</span>
</pre>
</div>
<p>
A fixed-length code would take at least 3 bits per symbol times 36
symbols for a total of 108 bits.
</p>
</div>
</div>
<div id="outline-container-org6abd4b9" class="outline-4">
<h4 id="org6abd4b9">Exercise 2.71</h4>
<div class="outline-text-4" id="text-org6abd4b9">
<p>
The trees look like lists: each non-leaf node has one leaf child and
one non-leaf child. The most frequent symbol takes one bit, and the
least frequent symbol takes \(n-1\) bits.
</p>
</div>
</div>
<div id="outline-container-org493be07" class="outline-4">
<h4 id="org493be07">Exercise 2.72</h4>
<div class="outline-text-4" id="text-org493be07">
<p>
If the relative frequencies are as described in exercise 2.71, then
the <kbd>memq</kbd> call in <kbd>encode-1</kbd> searches a list of length one at each
node, which is a constant-time operation. Therefore each of the \(n\)
iterations (in the worst case) of <kbd>encode-1</kbd> are
constant-time. Therefore <kbd>encode-1</kbd> has growth \(O(n)\). <kbd>reverse</kbd> and
the <kbd>memq</kbd> call in <kbd>encode</kbd> also have growth \(O(n)\), so <kbd>encode</kbd> has
time-complexity \(O(n)\) where \(n\) is the number of symbols in the
alphabet.
</p>
</div>
</div>
</div>
<div id="outline-container-orgdede9c5" class="outline-3">
<h3 id="orgdede9c5">Section 2.4</h3>
<div class="outline-text-3" id="text-orgdede9c5">
</div>
<div id="outline-container-orgbd47114" class="outline-4">
<h4 id="orgbd47114">Exercise 2.73</h4>
<div class="outline-text-4" id="text-orgbd47114">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">same-variable?</span> v1 v2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>variable? v1<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>variable? v2<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>eq? v1 v2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">deriv</span> exp var<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>number? exp<span style="color: #93E0E3;">)</span> 0<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>variable? exp<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>same-variable? exp var<span style="color: #9FC59F;">)</span> 1 0<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>get 'deriv <span style="color: #94BFF3;">(</span>operator exp<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>operands exp<span style="color: #9FC59F;">)</span>
               var<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">operator</span> exp<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>car exp<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">operands</span> exp<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>cdr exp<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<ol class="org-ol">
<li></li>
</ol>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">install-prefix-system</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">deriv-sum</span> sum<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>make-sum <span style="color: #93E0E3;">(</span>deriv <span style="color: #9FC59F;">(</span>addend exp<span style="color: #9FC59F;">)</span> var<span style="color: #93E0E3;">)</span>
              <span style="color: #93E0E3;">(</span>deriv <span style="color: #9FC59F;">(</span>augend exp<span style="color: #9FC59F;">)</span> var<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">deriv-product</span> prod<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>make-sum
     <span style="color: #93E0E3;">(</span>make-product <span style="color: #9FC59F;">(</span>multiplier exp<span style="color: #9FC59F;">)</span>
                   <span style="color: #9FC59F;">(</span>deriv <span style="color: #94BFF3;">(</span>multiplicand exp<span style="color: #94BFF3;">)</span> var<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
     <span style="color: #93E0E3;">(</span>make-product <span style="color: #9FC59F;">(</span>deriv <span style="color: #94BFF3;">(</span>multiplier exp<span style="color: #94BFF3;">)</span> var<span style="color: #9FC59F;">)</span>
                   <span style="color: #9FC59F;">(</span>multiplicand exp<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>put 'deriv '+ deriv-sum<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>put 'deriv '* deriv-product<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfac3fb6" class="outline-3">
<h3 id="orgfac3fb6">Section 2.5</h3>
<div class="outline-text-3" id="text-orgfac3fb6">
</div>
<div id="outline-container-org26684d3" class="outline-4">
<h4 id="org26684d3">Exercise 2.77</h4>
<div class="outline-text-4" id="text-org26684d3">
<p>
<kbd>magnitude</kbd> was already defined in 2.4.3 as:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">magnitude</span> z<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>apply-generic 'magnitude z<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
This was done to provide a generic interface for getting the magnitude
of a complex number whether it's represented in rectangular or polar
coordinates. A function taking a complex number tagged with
<kbd>'polar</kbd> and a function taking a complex number tagged with
<kbd>'rectangular</kbd> were already added to the table.
</p>
</div>
</div>
<div id="outline-container-orgadd2c47" class="outline-4">
<h4 id="orgadd2c47">Exercise 2.78</h4>
<div class="outline-text-4" id="text-orgadd2c47">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">attach-tag</span> type-tag contents<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>eq? type-tag 'scheme-number<span style="color: #D0BF8F;">)</span>
      contents
      <span style="color: #D0BF8F;">(</span>cons type-tag contents<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">type-tag</span> datum<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>number? datum<span style="color: #93E0E3;">)</span> 'scheme-number<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>pair? datum<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>car datum<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>error <span style="color: #CC9393;">"Bad tagged datum -- TYPE-TAG"</span> datum<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">contents</span> datum<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>number? datum<span style="color: #93E0E3;">)</span> datum<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>pair? datum<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cdr datum<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>error <span style="color: #CC9393;">"Bad tagged datum -- CONTENTS"</span> datum<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org01def75" class="outline-4">
<h4 id="org01def75">Exercise 2.79</h4>
<div class="outline-text-4" id="text-org01def75">
<p>
The following solution tests equality of numbers in the arithmetic
package that have the same type. For a more general approach that
allows compation numbers with different types, see Exercise 2.85.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">equ?-num</span> a b<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>= a b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'equ? '<span style="color: #BFEBBF;">(</span>scheme-number scheme-number<span style="color: #BFEBBF;">)</span> equ?-num<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">equ?-rat</span> a b<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>numer a<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>numer b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
                            <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>denom a<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>denom b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'equ? '<span style="color: #BFEBBF;">(</span>rational rational<span style="color: #BFEBBF;">)</span> equ?-rat<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">equ?-complex</span> a b<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>real-part a<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>real-part b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
                                <span style="color: #D0BF8F;">(</span>= <span style="color: #93E0E3;">(</span>imag-part a<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>imag-part b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'equ? '<span style="color: #BFEBBF;">(</span>complex complex<span style="color: #BFEBBF;">)</span> equ?-complex<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">equ?</span> a b<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>apply-generic 'equ? a b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
With the current implementation of complex and rational numbers as
pairs of scheme numbers, using <kbd>=</kbd> within <kbd>equ?-rat</kbd> and
<kbd>equ?-complex</kbd> should work. But because <kbd>equ?</kbd> works with
scheme-numbers too, recursively testing the components of complex and
rational numbers by replacing <kbd>=</kbd> with <kbd>equ?</kbd> in <kbd>equ?-rat</kbd> and
<kbd>equ?-complex</kbd> will also work with future representations of complex
and rational numbers that internally use numbers from our number
package&#x2026;
</p>
</div>
</div>
<div id="outline-container-org1748131" class="outline-4">
<h4 id="org1748131">Exercise 2.80</h4>
<div class="outline-text-4" id="text-org1748131">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">=zero?</span> x<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>apply-generic '=zero? x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put '=zero? '<span style="color: #BFEBBF;">(</span>scheme-number<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>= x 0<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">=zero?-complex</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>magnitude x<span style="color: #D0BF8F;">)</span> 0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put '=zero? '<span style="color: #BFEBBF;">(</span>complex<span style="color: #BFEBBF;">)</span> =zero?-complex<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">=zero?-rat</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>numer x<span style="color: #D0BF8F;">)</span> 0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put '=zero?-rat '<span style="color: #BFEBBF;">(</span>rational<span style="color: #BFEBBF;">)</span> =zero?-rat<span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org717aa90" class="outline-4">
<h4 id="org717aa90">Exercise 2.81</h4>
<div class="outline-text-4" id="text-org717aa90">
<ol class="org-ol">
<li>Infinite recursion: <kbd>apply-generic</kbd> coerces the first complex
number to a complex number, and calls itself.</li>
<li><p>
Code:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">apply-generic</span> op . args<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>type-tags <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> type-tag args<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>proc <span style="color: #94BFF3;">(</span>get op type-tags<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> proc
          <span style="color: #9FC59F;">(</span>apply proc <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> contents args<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>= <span style="color: #E0CF9F;">(</span>length args<span style="color: #E0CF9F;">)</span> 2<span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #E0CF9F;">(</span><span style="color: #8FB28F;">(</span>type1 <span style="color: #6CA0A3;">(</span>car type-tags<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                    <span style="color: #8FB28F;">(</span>type2 <span style="color: #6CA0A3;">(</span>cadr type-tags<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                    <span style="color: #8FB28F;">(</span>a1 <span style="color: #6CA0A3;">(</span>car args<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                    <span style="color: #8FB28F;">(</span>a2 <span style="color: #6CA0A3;">(</span>cadr args<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span>
                <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #8FB28F;">(</span>eq? type1 type2<span style="color: #8FB28F;">)</span>
                    <span style="color: #8FB28F;">(</span>error <span style="color: #CC9393;">"No method for these types"</span>
                           <span style="color: #6CA0A3;">(</span>list op type-tags<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                    <span style="color: #8FB28F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #6CA0A3;">(</span><span style="color: #DCDCCC;">(</span>t1-&gt;t2 <span style="color: #BFEBBF;">(</span>get-coercion type1 type2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
                          <span style="color: #DCDCCC;">(</span>t2-&gt;t1 <span style="color: #BFEBBF;">(</span>get-coercion type2 type1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span>
                      <span style="color: #6CA0A3;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #DCDCCC;">(</span>t1-&gt;t2
                             <span style="color: #BFEBBF;">(</span>apply-generic op <span style="color: #D0BF8F;">(</span>t1-&gt;t2 a1<span style="color: #D0BF8F;">)</span> a2<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
                            <span style="color: #DCDCCC;">(</span>t2-&gt;t1
                             <span style="color: #BFEBBF;">(</span>apply-generic op a1 <span style="color: #D0BF8F;">(</span>t2-&gt;t1 a2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
                            <span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span>
                             <span style="color: #BFEBBF;">(</span>error <span style="color: #CC9393;">"No method for these types"</span>
                                    <span style="color: #D0BF8F;">(</span>list op type-tags<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span>error <span style="color: #CC9393;">"No method for these types"</span>
                     <span style="color: #E0CF9F;">(</span>list op type-tags<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div></li>
</ol>
</div>
</div>
<div id="outline-container-orgc2f36e8" class="outline-4">
<h4 id="orgc2f36e8">Exercise 2.82</h4>
<div class="outline-text-4" id="text-orgc2f36e8">
<p>
Imagine an arithmetic package for complex, real, and imaginary
numbers. Both real and imaginary numbers are subtypes of complex
numbers, but real and imaginary numbers are unrelated to each
other. If one tried to <kbd>add</kbd> a real number and a complex number, this
would only be possible if each was converted (raised) to a complex
number. With the current type-coercion algorithm, this is not possible.
</p>

<p>
One way to approach a fully general coercion system for two arguments
would be to determine all possible types that the first argument can
be coerced into, and, for each of these types, coerce the first
argument and retry the operation with each of the possible types of
the second argument in turn.
</p>

<p>
After thinking about this for a while, I do not know enough about the
use case to make a satisfactory general procedure. I can imagine
situations where:
</p>
<ul class="org-ul">
<li>The arguments can be coereced into new types in multiple valid
ways. Which coercions should be preferred?</li>
<li>The arguments can be "downcast". For example, a quadrilateral may
happen to be a square, and so it is valid to coerce such a
quadrilateral into a square. Should implicit coercion be allowed
here?</li>
<li>The only coercion that allows the operation to succeed requires that
an argument be coerced into a distant type. Should such coercion
happen automatically, or require that the caller be more explicit?</li>
</ul>

<p>
Instead, we will try the more naive method suggested in the exercise:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">apply-generic</span> op . args<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>type-tags <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> type-tag args<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">(</span><span style="color: #93E0E3;">fail</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>error <span style="color: #CC9393;">"No method for these types"</span>
                          <span style="color: #9FC59F;">(</span>list op type-tags<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">(</span><span style="color: #93E0E3;">try-coerce</span> targets<span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>null? targets<span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>fail<span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let*</span> <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>targ <span style="color: #8FB28F;">(</span>car targets<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span>
                 <span style="color: #E0CF9F;">(</span>funcs <span style="color: #8FB28F;">(</span>filter! null?
                                 <span style="color: #6CA0A3;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #BFEBBF;">(</span>type<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>get-coercion type targ<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
                                      type-tags<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
            <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #E0CF9F;">(</span>= <span style="color: #8FB28F;">(</span>length funcs<span style="color: #8FB28F;">)</span> <span style="color: #8FB28F;">(</span>length args<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span>
                <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #8FB28F;">(</span><span style="color: #6CA0A3;">(</span>proc <span style="color: #DCDCCC;">(</span>get op <span style="color: #BFEBBF;">(</span>repeat <span style="color: #D0BF8F;">(</span>length args<span style="color: #D0BF8F;">)</span> targ<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                  <span style="color: #8FB28F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> proc
                      <span style="color: #6CA0A3;">(</span>apply proc <span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> contents <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> apply
                                                     funcs
                                                     <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> list args<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span>
                      <span style="color: #6CA0A3;">(</span>try-coerce <span style="color: #DCDCCC;">(</span>cdr targets<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>proc <span style="color: #94BFF3;">(</span>get op type-tags<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> proc
          <span style="color: #9FC59F;">(</span>apply proc <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> contents args<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #94BFF3;">(</span><span style="color: #E0CF9F;">(</span>all-types <span style="color: #8FB28F;">(</span>remove-duplicates type-tags<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
            <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #E0CF9F;">(</span>length-1 all-types<span style="color: #E0CF9F;">)</span>
                <span style="color: #E0CF9F;">(</span>fail<span style="color: #E0CF9F;">)</span>
                <span style="color: #E0CF9F;">(</span>try-coerce all-types<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
<p>
Usually, circular inheritance does not make sense. Therefore there
cannot be cycles in a general graph of type relationships. Therefore,
given two types a and b, at most one type can be an ancestor of the
other. If downcasting is to be explicit, then method of attempting to
coerce all of the args into the type of the first arg, then the second
arg, etc. is equivalent to attempting to coerce all of the args into
the type of the arg with the highest type in the hierarchy (because
all of the coercions that attempt to coerce the arg with the highest
type to any lower type will fail because we've said downcasting is
explicit).
</p>
</div>
</div>
<div id="outline-container-org22827f2" class="outline-4">
<h4 id="org22827f2">Exercise 2.83</h4>
<div class="outline-text-4" id="text-org22827f2">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">int-&gt;rat</span> int<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-rational int 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'raise 'int int-&gt;rat<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">rat-&gt;real</span> rat<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-real <span style="color: #D0BF8F;">(</span>/ <span style="color: #93E0E3;">(</span>numer rat<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>denom rat<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'raise 'rat rat-&gt;real<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">real-&gt;complex</span> real<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-complex-real-imag real 0<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'raise 'real raise-real<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">raise</span> num<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #D0BF8F;">(</span>get 'raise <span style="color: #93E0E3;">(</span>type-tag num<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>contents num<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1a422e8" class="outline-4">
<h4 id="org1a422e8">Exercise 2.84</h4>
<div class="outline-text-4" id="text-org1a422e8">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">ancestor?</span> arg1 arg2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>func <span style="color: #9FC59F;">(</span>get 'raise <span style="color: #94BFF3;">(</span>tag arg2<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> func
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>super <span style="color: #E0CF9F;">(</span>func <span style="color: #8FB28F;">(</span>contents arg2<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>= <span style="color: #E0CF9F;">(</span>tag super<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>tag arg1<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
              super
              <span style="color: #94BFF3;">(</span>ancestor? arg1 super<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        #f<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">apply-generic</span> op . args<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>type-tags <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> type-tag args<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>proc <span style="color: #94BFF3;">(</span>get op type-tags<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> proc
          <span style="color: #9FC59F;">(</span>apply proc <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> contents args<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>= <span style="color: #E0CF9F;">(</span>length args<span style="color: #E0CF9F;">)</span> 2<span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #E0CF9F;">(</span><span style="color: #8FB28F;">(</span>a1 <span style="color: #6CA0A3;">(</span>car args<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                    <span style="color: #8FB28F;">(</span>a2 <span style="color: #6CA0A3;">(</span>cadr args<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span>
                <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #8FB28F;">(</span><span style="color: #6CA0A3;">(</span>a2-&gt;type1 <span style="color: #DCDCCC;">(</span>ancestor? a1 a2<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span>
                      <span style="color: #6CA0A3;">(</span>a1-&gt;type2 <span style="color: #DCDCCC;">(</span>ancestor? a2 a1<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                  <span style="color: #8FB28F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #6CA0A3;">(</span>a2-&gt;type1
                         <span style="color: #DCDCCC;">(</span>apply-generic op a1 a2-&gt;type1<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span>
                        <span style="color: #6CA0A3;">(</span>a1-&gt;type2
                         <span style="color: #DCDCCC;">(</span>apply-generic op a1-&gt;type2 a2<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span>
                        <span style="color: #6CA0A3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span>
                         <span style="color: #DCDCCC;">(</span>error <span style="color: #CC9393;">"No method for these types"</span>
                                <span style="color: #BFEBBF;">(</span>list op type-tags<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span>error <span style="color: #CC9393;">"No method for these types"</span>
                     <span style="color: #E0CF9F;">(</span>list op type-tags<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org3ba3d7c" class="outline-4">
<h4 id="org3ba3d7c">Exercise 2.85</h4>
<div class="outline-text-4" id="text-org3ba3d7c">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">project-complex</span> complex<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-real <span style="color: #D0BF8F;">(</span>real-part complex<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'project 'complex 'project-complex<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">project-real</span> real<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-rat <span style="color: #D0BF8F;">(</span>round real<span style="color: #D0BF8F;">)</span> 1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'project 'real 'project-real<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">project-rat</span> rat<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-int <span style="color: #D0BF8F;">(</span>round <span style="color: #93E0E3;">(</span>/ <span style="color: #9FC59F;">(</span>numer rat<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>denom rat<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'project 'rat 'project-rat<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">project</span> num<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>apply-generic 'project num<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">drop</span> num<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>get 'project <span style="color: #93E0E3;">(</span>type-tag num<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>projection <span style="color: #94BFF3;">(</span>project num<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>equ? num <span style="color: #94BFF3;">(</span>raise projection<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
            <span style="color: #9FC59F;">(</span>drop <span style="color: #94BFF3;">(</span>projection<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
            num<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      num<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">apply-generic</span> op . args<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>type-tags <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> type-tag args<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>proc <span style="color: #94BFF3;">(</span>get op type-tags<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> proc
          <span style="color: #9FC59F;">(</span>drop <span style="color: #94BFF3;">(</span>apply proc <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> contents args<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>= <span style="color: #E0CF9F;">(</span>length args<span style="color: #E0CF9F;">)</span> 2<span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #E0CF9F;">(</span><span style="color: #8FB28F;">(</span>a1 <span style="color: #6CA0A3;">(</span>car args<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                    <span style="color: #8FB28F;">(</span>a2 <span style="color: #6CA0A3;">(</span>cadr args<span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span>
                <span style="color: #E0CF9F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #8FB28F;">(</span><span style="color: #6CA0A3;">(</span>a2-&gt;type1 <span style="color: #DCDCCC;">(</span>ancestor? a1 a2<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span>
                      <span style="color: #6CA0A3;">(</span>a1-&gt;type2 <span style="color: #DCDCCC;">(</span>ancestor? a2 a1<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span>
                  <span style="color: #8FB28F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #6CA0A3;">(</span>a2-&gt;type1
                         <span style="color: #DCDCCC;">(</span>apply-generic op a1 a2-&gt;type1<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span>
                        <span style="color: #6CA0A3;">(</span>a1-&gt;type2
                         <span style="color: #DCDCCC;">(</span>apply-generic op a1-&gt;type2 a2<span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span>
                        <span style="color: #6CA0A3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span>
                         <span style="color: #DCDCCC;">(</span>error <span style="color: #CC9393;">"No method for these types"</span>
                                <span style="color: #BFEBBF;">(</span>list op type-tags<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span><span style="color: #6CA0A3;">)</span><span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span>error <span style="color: #CC9393;">"No method for these types"</span>
                     <span style="color: #E0CF9F;">(</span>list op type-tags<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0b3f40f" class="outline-4">
<h4 id="org0b3f40f">Exercise 2.86</h4>
<div class="outline-text-4" id="text-org0b3f40f">
<p>
Depending on whether we want to store complex numbers internally as
rational numbers (or other future numbers), or just to handle making
complex numbers from rational numbers (or other future numbers) we
would need to:
</p>
<ul class="org-ul">
<li>Make both of the <kbd>make-complex-from-</kbd> procedures generic</li>
<li>Replace <kbd>+</kbd>, <kbd>-</kbd>, <kbd>*</kbd>, and <kbd>/</kbd> with <kbd>add</kbd>, <kbd>sub</kbd>, <kbd>mul</kbd>, and <kbd>div</kbd>
in internal procedures <kbd>add-complex</kbd>, <kbd>sub-complex</kbd>, etc</li>
<li>Rewrite polar- and rectangular- complex-number pacakges to use
generic procedures <kbd>sine</kbd>, <kbd>cosine</kbd>, <kbd>atangent</kbd>, <kbd>sqrt</kbd>, <kbd>plus</kbd></li>
<li>Rewrite <kbd>project-complex</kbd> and <kbd>raise-complex</kbd></li>
</ul>
</div>
</div>
<div id="outline-container-org6c81fdc" class="outline-4">
<h4 id="org6c81fdc">Exercise 2.87</h4>
<div class="outline-text-4" id="text-org6c81fdc">
<p>
Because <kbd>=zero?</kbd> is used in <kbd>adjoin-term</kbd>, zero coefficients are left
out of polynomials constructed with <kbd>add</kbd> and <kbd>mul</kbd>. If we rewrite
<kbd>make-poly</kbd> so that terms with zero coefficients are not actually
stored, then any polynomial that can be created will not no terms with
zero coefficients. Therefore the zero polynomial will simply have no
terms:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>put '=zero? 'poly empty-termlist?<span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdb9e2be" class="outline-4">
<h4 id="orgdb9e2be">Exercise 2.88</h4>
<div class="outline-text-4" id="text-orgdb9e2be">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">neg-poly</span> poly<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">neg-terms</span> terms<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>empty-termlist? terms<span style="color: #93E0E3;">)</span>
        terms
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>first <span style="color: #E0CF9F;">(</span>first-term terms<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>adjoin-term <span style="color: #94BFF3;">(</span>make-term <span style="color: #E0CF9F;">(</span>order first<span style="color: #E0CF9F;">)</span>
                                  <span style="color: #E0CF9F;">(</span>neg <span style="color: #8FB28F;">(</span>coeff first<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
                       <span style="color: #94BFF3;">(</span>neg-terms <span style="color: #E0CF9F;">(</span>rest-terms terms<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>make-poly <span style="color: #D0BF8F;">(</span>variable poly<span style="color: #D0BF8F;">)</span>
             <span style="color: #D0BF8F;">(</span>neg-terms <span style="color: #93E0E3;">(</span>term-list poly<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'neg 'poly neg-poly<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sub-poly</span> p1 p2<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>add-poly p1 <span style="color: #D0BF8F;">(</span>neg p2<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>put 'sub 'poly sub-poly<span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<i>BTC Address: bc1qlpu2c7ltxrz5fd2a977ywedlp9u4lvukvluc3d</i>
</div>
</body>
</html>