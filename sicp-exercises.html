<!doctype html>
<html lang="en">
<head>
<title>SICP Exercises (Work in progress)</title>
<!-- 2020-05-20 Wed 22:45 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Org-mode">
<meta name="author" content="Tanner Hoelzel">

<link  href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style type="text/css">
/* org mode styles on top of twbs */

html {
    position: relative;
    min-height: 100%;
}

body {
    font-size: 18px;
    margin-bottom: 105px;
}

footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 101px;
    background-color: #f5f5f5;
}

footer > div {
    padding: 10px;
}

footer p {
    margin: 0 0 5px;
    text-align: center;
    font-size: 16px;
}

#table-of-contents {
    margin-top: 20px;
    margin-bottom: 20px;
}

blockquote p {
    font-size: 18px;
}

pre {
    font-size: 16px;
}

.footpara {
    display: inline-block;
}

figcaption {
  font-size: 16px;
  color: #666;
  font-style: italic;
  padding-bottom: 15px;
}

/* from twbs docs */

.bs-docs-sidebar.affix {
    position: static;
}
@media (min-width: 768px) {
    .bs-docs-sidebar {
        padding-left: 20px;
    }
}

/* All levels of nav */
.bs-docs-sidebar .nav > li > a {
    display: block;
    padding: 4px 20px;
    font-size: 14px;
    font-weight: 500;
    color: #999;
}
.bs-docs-sidebar .nav > li > a:hover,
.bs-docs-sidebar .nav > li > a:focus {
    padding-left: 19px;
    color: #A1283B;
    text-decoration: none;
    background-color: transparent;
    border-left: 1px solid #A1283B;
}
.bs-docs-sidebar .nav > .active > a,
.bs-docs-sidebar .nav > .active:hover > a,
.bs-docs-sidebar .nav > .active:focus > a {
    padding-left: 18px;
    font-weight: bold;
    color: #A1283B;
    background-color: transparent;
    border-left: 2px solid #A1283B;
}

/* Nav: second level (shown on .active) */
.bs-docs-sidebar .nav .nav {
    display: none; /* Hide by default, but at >768px, show it */
    padding-bottom: 10px;
}
.bs-docs-sidebar .nav .nav > li > a {
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 30px;
    font-size: 12px;
    font-weight: normal;
}
.bs-docs-sidebar .nav .nav > li > a:hover,
.bs-docs-sidebar .nav .nav > li > a:focus {
    padding-left: 29px;
}
.bs-docs-sidebar .nav .nav > .active > a,
.bs-docs-sidebar .nav .nav > .active:hover > a,
.bs-docs-sidebar .nav .nav > .active:focus > a {
    padding-left: 28px;
    font-weight: 500;
}

/* Nav: third level (shown on .active) */
.bs-docs-sidebar .nav .nav .nav {
    padding-bottom: 10px;
}
.bs-docs-sidebar .nav .nav .nav > li > a {
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 40px;
    font-size: 12px;
    font-weight: normal;
}
.bs-docs-sidebar .nav .nav .nav > li > a:hover,
.bs-docs-sidebar .nav .nav .nav > li > a:focus {
    padding-left: 39px;
}
.bs-docs-sidebar .nav .nav .nav > .active > a,
.bs-docs-sidebar .nav .nav .nav > .active:hover > a,
.bs-docs-sidebar .nav .nav .nav > .active:focus > a {
    padding-left: 38px;
    font-weight: 500;
}

/* Show and affix the side nav when space allows it */
@media (min-width: 992px) {
    .bs-docs-sidebar .nav > .active > ul {
        display: block;
    }
    /* Widen the fixed sidebar */
    .bs-docs-sidebar.affix,
    .bs-docs-sidebar.affix-bottom {
        width: 213px;
    }
    .bs-docs-sidebar.affix {
        position: fixed; /* Undo the static from mobile first approach */
        top: 20px;
    }
    .bs-docs-sidebar.affix-bottom {
        position: absolute; /* Undo the static from mobile first approach */
    }
    .bs-docs-sidebar.affix .bs-docs-sidenav,.bs-docs-sidebar.affix-bottom .bs-docs-sidenav {
        margin-top: 0;
        margin-bottom: 0
    }
}
@media (min-width: 1200px) {
    /* Widen the fixed sidebar again */
    .bs-docs-sidebar.affix-bottom,
    .bs-docs-sidebar.affix {
        width: 263px;
    }
}
</style>
<script type="text/javascript">
$(function() {
    'use strict';

    $('.bs-docs-sidebar li').first().addClass('active');

    $(document.body).scrollspy({target: '.bs-docs-sidebar'});

    $('.bs-docs-sidebar').affix();
});
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "center",
  displayIndent: "2em",
  messageStyle: "none",
  "HTML-CSS": {
    scale: 100,
    styles: {
      ".MathJax_Display": {
        "font-size": "100%"
      }
    }
  },
  "SVG": {
    scale: 100,
    styles: {
      ".MathJax_SVG_Display": {
        "font-size": "100%",
        "margin-left": "-2.281em"
      }
    }
  }
});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"></script>
</head>
<body>
<div id="content" class="container">
<div class="row"><div class="col-md-9"><h1 class="title">SICP Exercises (Work in progress)</h1>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Section 1.1</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-0-1" class="outline-4">
<h4 id="sec-1-0-1">Exercise 1.3</h4>
<div class="outline-text-4" id="text-1-0-1">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">square</span> x)
(* x x))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">sum-of-squares-of-largest</span> a b c)
  (- (+ (square a) (square b) (square c))
     (<span style="color: #a020f0;">cond</span> ((<span style="color: #a020f0;">and</span> (&lt; a b) (&lt; a c)) a)
           ((&lt; b c) b)
           (<span style="color: #a020f0;">else</span> c))))
</pre>
</div>
<p>
A recursive procedure is simply one that calls itself by name. It is
not necessarily a recursive process.
</p>

<p>
“Programs must be written for people to read, and only incidentally
for computers to execute”
</p>
</div>
</div>
<div id="outline-container-sec-1-0-2" class="outline-4">
<h4 id="sec-1-0-2">Exercise 1.6</h4>
<div class="outline-text-4" id="text-1-0-2">
<p>
Enters a recursive loop not because a cond structure is used instead
of an if structure but because a function is called instead of using
an if (or cond) structure. If new-if were implemented with if instead
of cond, the code would also enter an infinite loop.
</p>

<p>
“The set of expressions for which a binding defines a name is called
the scope of that name”
</p>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Section 1.2</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-0-1" class="outline-4">
<h4 id="sec-2-0-1">Exercise 1.9</h4>
<div class="outline-text-4" id="text-2-0-1">
<p>
First (recursive)
</p>

<p>
(+ 4 5)
</p>

<p>
(inc (+ (dec 4) 5))
</p>

<p>
(inc (+ 3 5))
</p>

<p>
(inc (inc (+ (dec 3) 5)))
</p>

<p>
(inc (inc (+ 2 5)))
</p>

<p>
(inc (inc (inc (+ (dec 2) 5))))
</p>

<p>
(inc (inc (inc (+ 1 5))))
</p>

<p>
(inc (inc (inc (inc (+ (dec 1) 5)))))
</p>

<p>
(inc (inc (inc (inc (+ 0 5)))))
</p>

<p>
(inc (inc (inc (inc 5))))
</p>

<p>
(inc (inc (inc 6)))
</p>

<p>
(inc (inc 7))
</p>

<p>
(inc 8)
</p>

<p>
9
</p>

<p>
Second (iterative)
</p>

<p>
(+ 4 5)
</p>

<p>
(+ (dec 4) (inc 5))
</p>

<p>
(+ 3 6)
</p>

<p>
(+ (dec 3) (inc 6))
</p>

<p>
(+ 2 7)
</p>

<p>
(+ (dec 2) (inc 7))
</p>

<p>
(+ 1 8)
</p>

<p>
(+ (dec 1) (inc 8))
</p>

<p>
(+ 0 9)
</p>

<p>
9
</p>

<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-count-change</span> amt values)
  (<span style="color: #a020f0;">cond</span> ((null? values) 0)
        ((&lt; amt 0) 0)
        ((= amt 0) 1)
        (<span style="color: #a020f0;">else</span> (+ (my-count-change (- amt (car values)) values)
                 (my-count-change amt (cdr values))))))

(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">count-change</span> amt)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">cc</span> amount kinds-of-coins)
    (<span style="color: #a020f0;">cond</span> ((= amount 0) 1)
          ((<span style="color: #a020f0;">or</span> (&lt; amount 0) (= kinds-of-coins 0)) 0)
          (<span style="color: #a020f0;">else</span> (+ (cc amount
                       (- kinds-of-coins 1))
                   (cc (- amount
                          (first-denomination kinds-of-coins))
                       kinds-of-coins)))))
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">first-denomination</span> kinds-of-coins)
    (<span style="color: #a020f0;">cond</span> ((= kinds-of-coins 1) 1)
          ((= kinds-of-coins 2) 5)
          ((= kinds-of-coins 3) 10)
          ((= kinds-of-coins 4) 25)
          ((= kinds-of-coins 5) 50)))
  (cc amt 5))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-0-2" class="outline-4">
<h4 id="sec-2-0-2">Exercise 1.11</h4>
<div class="outline-text-4" id="text-2-0-2">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">f</span> n)
  (<span style="color: #a020f0;">if</span> (&lt; n 3)
      n
      (+ (* 1 (f (- n 1)))
         (* 2 (f (- n 2)))
         (* 3 (f (- n 3))))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">f-iter</span> n)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterate</span> a b c count)
    (<span style="color: #a020f0;">if</span> (= count 0)
        a
        (iterate b
                c
                (+ c
                   (* b 2)
                   (* a 3))
                (- count 1))))
  (iterate 0 1 2 n))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-0-3" class="outline-4">
<h4 id="sec-2-0-3">Exercise 1.12</h4>
<div class="outline-text-4" id="text-2-0-3">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">pascal</span> n m)
  (<span style="color: #a020f0;">if</span> (<span style="color: #a020f0;">or</span> (= m 0)
          (= m n))
      1
      (+ (pascal (- n 1) (- m 1))
         (pascal (- n 1) m))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-0-4" class="outline-4">
<h4 id="sec-2-0-4">Exercise 1.16</h4>
<div class="outline-text-4" id="text-2-0-4">
<p>
If n even
</p>

<p>
b -&gt; b2
</p>

<p>
n -&gt; n/2 - 1
</p>

<p>
c -&gt; cb2
</p>

<p>
If n odd
</p>

<p>
b -&gt; b
</p>

<p>
n -&gt; n - 1
</p>

<p>
c -&gt; cb
</p>

<p>
Fibonacci numbers can be computed logarithmically too!
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fast-expt</span> base exp)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fast-iter</span> b n c)
    (<span style="color: #a020f0;">cond</span> ((= n 0) c)
          ((even? n) (fast-iter (* b b) (- (/ n 2) 1) (* c (* b b))))
          (<span style="color: #a020f0;">else</span> (fast-iter b (- n 1) (* c b)))))
  (fast-iter base exp 1))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">even?</span> n)
  (= (remainder n 2) 0))

<span style="color: #b22222;">;; </span><span style="color: #b22222;">And so here are all of the combinations of space-/time-complexity</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">we've seen so far:</span>

(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-expt</span> b n)
  (<span style="color: #a020f0;">if</span> (= n 0)
      1
      (* b (my-expt b (- n 1)))))

(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-expt-iter</span> base pow)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterate</span> n c)
    (<span style="color: #a020f0;">cond</span> ((= n 0) c)
          (<span style="color: #a020f0;">else</span> (iterate (- n 1) (* base c)))))
  (iterate pow 1))

(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-expt-log</span> base pow)
  (<span style="color: #a020f0;">cond</span> ((= pow 0) 1)
        ((even? pow) (square (my-expt-log base (/ pow 2))))
        (<span style="color: #a020f0;">else</span> (* base (my-expt-log base (- pow 1))))))

(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-expt-iter-log</span> base pow)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterate</span> b p c)
    (<span style="color: #a020f0;">cond</span> ((= p 0) c)
          ((even? p) (iterate (* b b) (/ p 2) c))
          (<span style="color: #a020f0;">else</span> (iterate b (- p 1) (* b c)))))
  (iterate base pow 1))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-0-5" class="outline-4">
<h4 id="sec-2-0-5">Exercise 1.17</h4>
<div class="outline-text-4" id="text-2-0-5">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">halve</span> b)
  (/ b 2))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">double</span> b)
  (+ b b))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">mult</span> a b)
  (<span style="color: #a020f0;">cond</span> ((= b 0) 0)
        ((even? b) (double (mult a (halve b))))
        (<span style="color: #a020f0;">else</span> (+ a (mult a (- b 1))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-0-6" class="outline-4">
<h4 id="sec-2-0-6">Exercise 1.18</h4>
<div class="outline-text-4" id="text-2-0-6">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fast-mult</span> x y)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fast-mult-iter</span> a b c)
    (<span style="color: #a020f0;">cond</span> ((= b 0) c)
          ((even? b) (fast-mult-iter (double a) (- (halve b) 1) (+ c (double a))))
          (<span style="color: #a020f0;">else</span> (fast-mult-iter a (- b 1) (+ c a)))))
  (fast-mult-iter x y 0))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-0-7" class="outline-4">
<h4 id="sec-2-0-7">Exercise 1.19</h4>
<div class="outline-text-4" id="text-2-0-7">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fib</span> n)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fib-iter</span> a b p q count)
    (<span style="color: #a020f0;">cond</span> ((= count 0) b)
          ((even? count)
           (fib-iter a
                     b
                     (+ (square p) (square q))
                     (+ (* 2 p q) (square q))
                     (/ count 2)))
          (<span style="color: #a020f0;">else</span> (fib-iter (+ (* b q) (* a q) (* a p))
                          (+ (* b p) (* a q))
                          p
                          q
                          (- count 1)))))
  (fib-iter 1 0 0 1 n))

(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-expmod</span> base exp mod)
  <span style="color: #8b2252;">"Generates an iterative process that runs in a logarithmic number of steps"</span>
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterate</span> b e i)
    (<span style="color: #a020f0;">cond</span> ((= e 0) i)
          ((even? e) (iterate (remainder (* b b) mod) (/ e 2) i))
          (<span style="color: #a020f0;">else</span> (iterate b (- e 1) (remainder (* b i) mod)))))
  (iterate base exp 1))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-0-8" class="outline-4">
<h4 id="sec-2-0-8">Exercise 1.22</h4>
<div class="outline-text-4" id="text-2-0-8">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">timed-prime-test</span> n)
  (newline)
  (display n)
  (start-prime-test n (runtime)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">start-prime-test</span> n start-time)
  (<span style="color: #a020f0;">if</span> (prime? n)
      (report-prime (- (runtime) start-time))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">report-prime</span> elapsed-time)
  (display <span style="color: #8b2252;">" *** "</span>)
  (display elapsed-time))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">search-for-primes</span> a b)
  (<span style="color: #a020f0;">cond</span> ((&lt; a b) (timed-prime-test a)
                 (search-for-primes (+ a 1) b))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">prime?</span> n)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterate</span> i)
    (<span style="color: #a020f0;">cond</span> ((= (remainder n i) 0) #f)
          ((&gt; (* i i) n) #t)
          (<span style="color: #a020f0;">else</span> (iterate (+ i 1)))))
  (iterate 2))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-0-9" class="outline-4">
<h4 id="sec-2-0-9">Exercise 1.26</h4>
<div class="outline-text-4" id="text-2-0-9">
<p>
From a high level, calling expmod with (/ exp 2) halves the
problem. It is this halving, at each iteration of the process, that
allows it to run in a number of steps that is logarithmically
related to the size of the input. When Louis calls expmod twice,
each with a halved problem (the same half) he is doing twice of
half of the original amount of work. Therefore he is doing the
original amount of work, which in the case of computing an exponent
would be n multiplications where n is the power being raised to.
</p>
</div>
</div>
<div id="outline-container-sec-2-0-10" class="outline-4">
<h4 id="sec-2-0-10">Exercise 1.27</h4>
<div class="outline-text-4" id="text-2-0-10">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fermat-condition?</span> a n)
  (= (my-expmod a n n) (remainder a n)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fermat-test?</span> n)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">satisfies?</span> a)
    (<span style="color: #a020f0;">cond</span> ((&gt;= a n) #t)
          ((fermat-condition? a n) (satisfies? (+ a 1)))
          (<span style="color: #a020f0;">else</span> #f)))
  (satisfies? 2))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">carmichael?</span> n)
  (<span style="color: #a020f0;">and</span> (not (prime? n)) (fermat-test? n)))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Section 1.3</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-0-1" class="outline-4">
<h4 id="sec-3-0-1">Exercise 1.29</h4>
<div class="outline-text-4" id="text-3-0-1">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">simp</span> f a b n)
  (<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">h</span> (/ (- b a) n))
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">step</span> x) (+ x h h))
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">cf</span> c x) (* c (f x)))
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">2f</span> x) (cf 2 x))
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">4f</span> x) (cf 4 x))
  (* (/ h 3.0)
     (+ (f a)
        (sum 4f (+ a h) step b)
        (sum 2f (+ a h h) step b)
        (f b))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-2" class="outline-4">
<h4 id="sec-3-0-2">Exercise 1.30</h4>
<div class="outline-text-4" id="text-3-0-2">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">sum</span> term a next b)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> a result)
     (<span style="color: #a020f0;">if</span> (&gt; a b)
         result
         (iter (next a) (+ result (term a)))))
  (iter a 0))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-3" class="outline-4">
<h4 id="sec-3-0-3">Exercise 1.31</h4>
<div class="outline-text-4" id="text-3-0-3">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">product-iter</span> term a next b)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> a result)
    (<span style="color: #a020f0;">if</span> (&gt; a b)
        result
        (iter (next a) (* result (term a)))))
  (iter a 1))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">product</span> term a next b)
  (<span style="color: #a020f0;">if</span> (&gt; a b)
      1
      (* (term a)
         (product term (next a) next b))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-4" class="outline-4">
<h4 id="sec-3-0-4">Exercise 1.32</h4>
<div class="outline-text-4" id="text-3-0-4">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">accumulate</span> combiner null-val term a next b)
  (<span style="color: #a020f0;">if</span> (&gt; a b)
      null-val
      (combiner (term a)
                (accumulate combiner null-val term (next a) next b))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">accumulate-iter</span> combiner null-val term a next b)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> a result)
    (<span style="color: #a020f0;">if</span> (&gt; a b)
        result
        (iter (next a) (combiner result (term a)))))
  (iter a null-val))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-5" class="outline-4">
<h4 id="sec-3-0-5">Exercise 1.33</h4>
<div class="outline-text-4" id="text-3-0-5">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">filtered-accumulate</span> filter combiner null-val term a next b)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> a result)
    (<span style="color: #a020f0;">cond</span> ((&gt; a b) result)
          ((filter a) (iter (next a) (combiner result (term a))))
          (<span style="color: #a020f0;">else</span> (iter (next a) (combiner result null-val)))))
  (iter a null-val))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">sum-square-primes</span> a b)
  (filtered-accumulate prime? + 0 square a inc b))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">product-coprimes</span> n)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">filt</span> a)
    (= (gcd a n) 1))
  (filtered-accumulate filt * 1 (<span style="color: #a020f0;">lambda</span> (x) x) 2 inc n))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">gcd</span> a b)
  (<span style="color: #a020f0;">if</span> (= b 0)
      a
      (gcd b (remainder a b))))

(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">factorial</span> b)
  (product (<span style="color: #a020f0;">lambda</span> (x) x) 2 (<span style="color: #a020f0;">lambda</span> (x) (+ x 1)) b))
</pre>
</div>

<p>
Let is syntactic sugar for the underlying lambda application!
</p>

<p>
Iterative approximation of pi
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">4square</span> x)
  (* 4 (square x)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">4square1</span> x)
  (- (4square x) 1))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">inc</span> x)
  (+ x 1))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">pi-approx</span> n)
  (* 2.0 (/ (product-iter 4square 1 inc n)
            (product-iter 4square1 1 inc n))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-6" class="outline-4">
<h4 id="sec-3-0-6">Exercise 1.35</h4>
<div class="outline-text-4" id="text-3-0-6">
<p>
x<sup>2</sup> |-&gt; x + 1
</p>

<p>
x<sup>2</sup> - x - 1 = 0
</p>

<p>
(-(-1) +- sqrt((-1)<sup>2</sup> - 4(-1)))/2
</p>

<p>
(1 +- sqrt(5))/2
</p>
</div>
</div>
<div id="outline-container-sec-3-0-7" class="outline-4">
<h4 id="sec-3-0-7">Exercise 1.36</h4>
<div class="outline-text-4" id="text-3-0-7">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">tolerance</span> 0.00001)
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fixed-point</span> f first-guess)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">close-enough?</span> v1 v2)
    (&lt; (abs (- v1 v2)) tolerance))
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">try</span> guess)
    (newline)
    (display guess)
    (<span style="color: #a020f0;">let</span> ((next (f guess)))
      (<span style="color: #a020f0;">if</span> (close-enough? guess next)
          next
          (try next))))
  (try first-guess))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-8" class="outline-4">
<h4 id="sec-3-0-8">Exercise 1.37</h4>
<div class="outline-text-4" id="text-3-0-8">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">cont-frac</span> n d k)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">recurse</span> i)
    (<span style="color: #a020f0;">if</span> (= i k)
        0
        (/ (n i)
           (+ (d i) (recurse (+ i 1))))))
  (recurse 1))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">cont-frac</span> n d k)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> i result)
    (<span style="color: #a020f0;">if</span> (= i 0)
        result
        (iter (- i 1) (/ (n i)
                         (+ (d i) result)))))
  (iter k 0))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-9" class="outline-4">
<h4 id="sec-3-0-9">Exercise 1.38</h4>
<div class="outline-text-4" id="text-3-0-9">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">e-approx</span> k)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">d</span> k)
    (<span style="color: #a020f0;">if</span> (= (remainder k 3) 2)
        (+ 2.0 (* 2 (quotient k 3)))
        1.0))
  (+ 2 (cont-frac (<span style="color: #a020f0;">lambda</span> (x) 1.0) d k)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-10" class="outline-4">
<h4 id="sec-3-0-10">Exercise 1.39</h4>
<div class="outline-text-4" id="text-3-0-10">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">tan-cf</span> x k)
  (cont-frac (<span style="color: #a020f0;">lambda</span> (i) (<span style="color: #a020f0;">if</span> (= i 1)
                             x
                             (* -1.0 (square x))))
             (<span style="color: #a020f0;">lambda</span> (i) (- (* 2 i) 1.0))
             k))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-11" class="outline-4">
<h4 id="sec-3-0-11">Exercise 1.40</h4>
<div class="outline-text-4" id="text-3-0-11">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">cubic</span> a b c)
  (<span style="color: #a020f0;">lambda</span> (x) (+ (cube x) (* a (square x)) (* b x) c)))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-12" class="outline-4">
<h4 id="sec-3-0-12">Exercise 1.41</h4>
<div class="outline-text-4" id="text-3-0-12">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">double</span> f)
  (<span style="color: #a020f0;">lambda</span> (x) (f (f x))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-13" class="outline-4">
<h4 id="sec-3-0-13">Exercise 1.42</h4>
<div class="outline-text-4" id="text-3-0-13">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">compose</span> f g)
  (<span style="color: #a020f0;">lambda</span> (x) (f (g x))))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-14" class="outline-4">
<h4 id="sec-3-0-14">Exercise 1.43</h4>
<div class="outline-text-4" id="text-3-0-14">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">repeated</span> f n)
  (<span style="color: #a020f0;">if</span> (= n 1)
      f
      (compose f (repeated f (- n 1)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">repeated-iter</span> f n)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> i g)
    (<span style="color: #a020f0;">if</span> (= i n)
        g
        (iter (+ i 1) (compose f g))))
  (iter 1 f))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">repeated-log</span> f n)
  (<span style="color: #a020f0;">cond</span> ((= n 1) f)
        ((even? n) (repeated-log (compose f f) (/ n 2)))
        (<span style="color: #a020f0;">else</span> (compose f (repeated-log f (- n 1))))))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-15" class="outline-4">
<h4 id="sec-3-0-15">Exercise 1.44</h4>
<div class="outline-text-4" id="text-3-0-15">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">sum-list</span> l)
  (<span style="color: #a020f0;">if</span> (null? l)
      0
      (+ (car l) (sum-list (cdr l)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">average-list</span> l)
  (/ (sum-list l) (length l)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">smooth</span> f)
  (<span style="color: #a020f0;">lambda</span> (x) (average-list (list (f (- x dx))
                                  (f x)
                                  (f (+ x dx))))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">n-fold-smoothed</span> f n)
  ((repeated smooth n) f))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-16" class="outline-4">
<h4 id="sec-3-0-16">Exercise 1.45</h4>
<div class="outline-text-4" id="text-3-0-16">
<p>
One average-damp works until fourth roots
</p>

<p>
Two average-damp's work until eighth roots
</p>

<p>
Three average-damp's work until sixteenth roots
</p>

<p>
I see a pattern&#x2026;
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">average-damp</span> f)
  (<span style="color: #a020f0;">lambda</span> (x) (average (list x (f x)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">sqrt</span> x)
  (fixed-point (average-damp (<span style="color: #a020f0;">lambda</span> (y) (/ x y)))
               1.0))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">lb</span> x)
  (/ (log x) (log 2)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">nth-root</span> k n)
  (fixed-point
   ((repeated average-damp (floor (lb n))) (<span style="color: #a020f0;">lambda</span> (x) (/ k (my-expt x (- n 1)))))
   1.0))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">difference</span> a b)
  (abs (- a b)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">test-nth-root</span> base exp)
  (&lt; (difference base
                 (nth-root (my-expt base exp)
                           exp))
     0.01))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-0-17" class="outline-4">
<h4 id="sec-3-0-17">Exercise 1.46</h4>
<div class="outline-text-4" id="text-3-0-17">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterative-improve</span> good-enough? improve-guess)
  (<span style="color: #a020f0;">lambda</span> (guess)
    (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterate</span> g)
      (<span style="color: #a020f0;">if</span> (good-enough? g)
          g
          (iterate (improve-guess g))))
    (iterate guess)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterative-improve-sqrt</span> x)
  ((iterative-improve (<span style="color: #a020f0;">lambda</span> (g) (&lt; (difference (square g) x) 0.001))
                      (<span style="color: #a020f0;">lambda</span> (g) (average (list g (/ x g))))) 1.0))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iterative-improve-fixed-point</span> func first-guess)
  ((iterative-improve (<span style="color: #a020f0;">lambda</span> (g) (&lt; (difference g (func g)) 0.00001))
                      func) first-guess))

</pre>
</div>
<p>
The general technique of isolating the parts of a program that deal
with how data objects are represented from the parts of a program
that deal with how data objects are used is a powerful design
methodology called "data abstraction".
</p>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Section 2.1</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-0-1" class="outline-4">
<h4 id="sec-4-0-1">Exercise 2.1</h4>
<div class="outline-text-4" id="text-4-0-1">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">same-sign?</span> a b)
  (&gt; (* a b) 0))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-rat</span> n d)
  (<span style="color: #a020f0;">let</span> ((g (gcd n d)))
    (cons (* (<span style="color: #a020f0;">cond</span> ((same-sign? n d) 1)
                   (<span style="color: #a020f0;">else</span> -1))
             (abs (/ n g)))
          (abs (/ d g)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">numer</span> x) (car x))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">denom</span> x) (cdr x))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">print-rat</span> x)
  (newline)
  (display (numer x))
  (display <span style="color: #8b2252;">"/"</span>)
  (display (denom x)))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-2" class="outline-4">
<h4 id="sec-4-0-2">Exercise 2.2</h4>
<div class="outline-text-4" id="text-4-0-2">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-point</span> x y)
  (cons x y))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">x-point</span> p) (car p))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">y-point</span> p) (cdr p))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">point-less</span> p1 p2)
  (<span style="color: #a020f0;">or</span> (&lt; (x-point p1) (x-point p2))
      (<span style="color: #a020f0;">and</span> (= (x-point p1) (x-point p2))
           (&lt; (y-point p1) (y-point p2)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">point-equal</span> p1 p2)
  (<span style="color: #a020f0;">and</span> (= (x-point p1) (x-point p2))
       (= (y-point p1) (y-point p2))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">point-equal</span> p1 p2)
  (<span style="color: #a020f0;">and</span> (not (point-less p1 p2))
       (not (point-less p2 p1))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-segment</span> start end)
  (<span style="color: #a020f0;">cond</span> ((point-less start end) (cons start end))
        (<span style="color: #a020f0;">else</span> (cons end start))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">start-segment</span> seg) (car seg))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">end-segment</span> seg) (cdr seg))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">average</span> a b)
  (/ (+ a b) 2))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">midpoint-segment</span> seg)
  (make-point (average (x-point (start-segment seg))
                       (x-point (end-segment seg)))
              (average (y-point (start-segment seg))
                       (y-point (end-segment seg)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">print-point</span> p)
  (newline)
  (display <span style="color: #8b2252;">"("</span>)
  (display (x-point p))
  (display <span style="color: #8b2252;">","</span>)
  (display (y-point p))
  (display <span style="color: #8b2252;">")"</span>))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-3" class="outline-4">
<h4 id="sec-4-0-3">Exercise 2.3</h4>
<div class="outline-text-4" id="text-4-0-3">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-rectangle</span> corner1 corner2)
  (<span style="color: #a020f0;">cond</span> ((<span style="color: #a020f0;">or</span> (= (x-point corner1) (x-point corner2))
             (= (y-point corner1) (y-point corner2)))
         (error <span style="color: #8b2252;">"Points define a segment"</span>))
        ((point-less corner1 corner2) (cons corner1 corner2))
        (<span style="color: #a020f0;">else</span> (cons corner2 corner1))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">height</span> rect)
  (difference (y-point (car rect)) (y-point (cdr rect))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">width</span> rect)
  (difference (x-point (car rect)) (x-point (cdr rect))))
</pre>
</div>
<p>
I won't get much more out of this by continuing&#x2026;
</p>
</div>
</div>
<div id="outline-container-sec-4-0-4" class="outline-4">
<h4 id="sec-4-0-4">Exercise 2.4</h4>
<div class="outline-text-4" id="text-4-0-4">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-cons</span> x y)
  (<span style="color: #a020f0;">lambda</span> (m) (m x y)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-car</span> z)
  (z (<span style="color: #a020f0;">lambda</span> (p q) p)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-cdr</span> z)
  (z (<span style="color: #a020f0;">lambda</span> (p q) q)))
</pre>
</div>
<p>
(my-cdr (my-cons 1 2))
</p>

<p>
((my-cons 1 2) (lambda (p q) q))
</p>

<p>
((lambda (m) (m 1 2)) (lambda (p q) q))
</p>

<p>
((lambda (p q) q) 1 2)
</p>

<p>
2
</p>
</div>
</div>
<div id="outline-container-sec-4-0-5" class="outline-4">
<h4 id="sec-4-0-5">Exercise 2.5</h4>
<div class="outline-text-4" id="text-4-0-5">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">log-base</span> base value)
  (/ (log value) (log base)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">factor-out</span> factor value)
  (<span style="color: #a020f0;">if</span> (= (remainder value factor) 0)
      (factor-out factor (/ value factor))
      value))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-cons</span> x y)
  (* (my-expt 2 x) (my-expt 3 y)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-car</span> p)
  (log-base 2 (factor-out 3 p)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">my-cdr</span> p)
  (log-base 3 (factor-out 2 p)))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-6" class="outline-4">
<h4 id="sec-4-0-6">Exercise 2.6</h4>
<div class="outline-text-4" id="text-4-0-6">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">zero</span> (<span style="color: #a020f0;">lambda</span> (f) (<span style="color: #a020f0;">lambda</span> (x) x)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">add-1</span> n)
  (<span style="color: #a020f0;">lambda</span> (f) (<span style="color: #a020f0;">lambda</span> (x) (f ((n f) x)))))
</pre>
</div>
<p>
(add-1 zero)
</p>

<p>
(lambda (f) (lambda (x) (f ((zero f) x))))
</p>

<p>
(lambda (f) (lambda (x) (f (((lambda (q) (lambda (z) z)) f) x))))
</p>

<p>
(lambda (f) (lambda (x) (f ((lambda (z) z) x))))
</p>

<p>
(lambda (f) (lambda (x) (f x)))
</p>

<p>
(lambda (f) (lambda (x) (f x)))
</p>

<p>
(add-1 (lambda (f) (lambda (x) (f x))))
</p>

<p>
(lambda (f) (lambda (x) (f (((lambda (g) (lambda (x) (g x))) f) x))))
</p>

<p>
(lambda (f) (lambda (x) (f ((lambda (x) (f x)) x))))
</p>

<p>
(lambda (f) (lambda (x) (f (f x))))
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">plus</span> a b)
  (<span style="color: #a020f0;">lambda</span> (f) (compose (a f) (b f))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-7" class="outline-4">
<h4 id="sec-4-0-7">Exercise 2.7</h4>
<div class="outline-text-4" id="text-4-0-7">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-interval</span> a b) (cons a b))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">lower-bound</span> int)
  (min (car int) (cdr int)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">upper-bound</span> int)
  (max (car int) (cdr int)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-8" class="outline-4">
<h4 id="sec-4-0-8">Exercise 2.8</h4>
<div class="outline-text-4" id="text-4-0-8">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">sub-interval</span> x y)
  (make-interval (- (lower-bound x) (upper-bound y))
                 (- (upper-bound x) (lower-bound y))))

</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-9" class="outline-4">
<h4 id="sec-4-0-9">Exercise 2.9</h4>
<div class="outline-text-4" id="text-4-0-9">
<p>
Let x = (a b) and y = (c d) be intervals. Then width(x) = (b-a)/2 and
width(y) = (d-c)/2. Well width(x+y) = width((a+c b+d)) = (b+d-a-c)/2 =
(b-a)/2 + (d-c)/2 = width(x)+width(y). And width(x-y) = width((a-d
b-c)) = (b-c-a+d)/2 = width(x) + width(y). Now let x1 = (1 2), x2 =
(3 4) and x3 = (5 6). Well width(x1) = width(x2) = width(x3) =
1/2. But width(x1*x2) = width((3 8)) = 5/2 and width(x2*x3) =
width(15 24) = 9/2. If product width were a function only of factor
widths then width(x1*x2) would equal width(x2*x3) (because width(x1) =
width(x2) = width(x3) = 1/2) but this is not the case. Similarly,
width(x1/x2) = width((1/4 2/3)) = 5/24 != width(x2/x3) = width((1/3
4/5)) = 7/30.
</p>
</div>
</div>
<div id="outline-container-sec-4-0-10" class="outline-4">
<h4 id="sec-4-0-10">Exercise 2.10</h4>
<div class="outline-text-4" id="text-4-0-10">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">width-interval</span> x)
  (/ (- (upper-bound x) (lower-bound x)) 2))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">mul-interval</span> x y)
       (<span style="color: #a020f0;">let</span> ((p1 (* (lower-bound x) (lower-bound y)))
             (p2 (* (lower-bound x) (upper-bound y)))
             (p3 (* (upper-bound x) (lower-bound y)))
             (p4 (* (upper-bound x) (upper-bound y))))
         (make-interval (min p1 p2 p3 p4)
                        (max p1 p2 p3 p4))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">div-interval</span> x y)
  (<span style="color: #a020f0;">if</span> (= (width-interval y) 0)
      (error <span style="color: #8b2252;">"Division by zero-width interval"</span>)
      (mul-interval x
      (make-interval (/ 1.0 (upper-bound y))
      (/ 1.0 (lower-bound y))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-11" class="outline-4">
<h4 id="sec-4-0-11">Exercise 2.11</h4>
<div class="outline-text-4" id="text-4-0-11">
<p>
If we're multiplying intervals \(i=(a,b)\) and \(j=(x,y)\) then we must have \(a \leq
b\) and \(x \leq y\) and so we have the following cases:
</p>
<table class="table table-striped table-bordered table-hover table-condensed" border="2" rules="all" frame="border">


<colgroup>
<col  class="left">

<col  class="left">

<col  class="left">

<col  class="left">
</colgroup>
<thead>
<tr>
<th scope="col" class="text-left">&#xa0;</th>
<th scope="col" class="text-left">\(a \leq b < 0\)</th>
<th scope="col" class="text-left">\(a < 0 \leq b\)</th>
<th scope="col" class="text-left">\(0 \leq a \leq b\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="text-left">\(x \leq y < 0\)</td>
<td class="text-left">\((by,ax)\)</td>
<td class="text-left">\((bx,ax)\)</td>
<td class="text-left">\((bx,ay)\)</td>
</tr>

<tr>
<td class="text-left">\(x < 0 \leq y\)</td>
<td class="text-left">\((ay,ax)\)</td>
<td class="text-left">\((min(ay,bx),min(ax,by))\)</td>
<td class="text-left">\((bx,by)\)</td>
</tr>

<tr>
<td class="text-left">\(0 \leq x \leq y\)</td>
<td class="text-left">\((ay,bx)\)</td>
<td class="text-left">\((ay,by)\)</td>
<td class="text-left">\((ax,by)\)</td>
</tr>
</tbody>
</table>
<p>
For simplicity's sake, we notice that multiplication is commutative
and simplify our table:
</p>
<table class="table table-striped table-bordered table-hover table-condensed" border="2" rules="all" frame="border">


<colgroup>
<col  class="left">

<col  class="left">

<col  class="left">

<col  class="left">
</colgroup>
<thead>
<tr>
<th scope="col" class="text-left">&#xa0;</th>
<th scope="col" class="text-left">\(a \leq b < 0\)</th>
<th scope="col" class="text-left">\(a < 0 \leq b\)</th>
<th scope="col" class="text-left">\(0 \leq a \leq b\)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="text-left">\(x \leq y < 0\)</td>
<td class="text-left">\((by,ax)\)</td>
<td class="text-left">\((bx,ax)\)</td>
<td class="text-left">\((bx,ay)\)</td>
</tr>

<tr>
<td class="text-left">\(x < 0 \leq y\)</td>
<td class="text-left">\(j*i\)</td>
<td class="text-left">\((min(ay,bx),min(ax,by))\)</td>
<td class="text-left">\((bx,by)\)</td>
</tr>

<tr>
<td class="text-left">\(0 \leq x \leq y\)</td>
<td class="text-left">\(j*i\)</td>
<td class="text-left">\(j*i\)</td>
<td class="text-left">\((ax,by)\)</td>
</tr>
</tbody>
</table>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">mul-interval</span> i j)
  (<span style="color: #a020f0;">let</span> ((a (lower-bound i))
        (b (upper-bound i))
        (x (lower-bound j))
        (y (upper-bound j)))
    (<span style="color: #a020f0;">cond</span> ((&lt; b 0) (<span style="color: #a020f0;">if</span> (&lt; y 0)
                       (make-interval (* b y) (* a x))
                       (mul-interval j i)))
          ((&lt; a 0) (<span style="color: #a020f0;">cond</span> ((&lt; y 0) (make-interval (* b x) (* a x)))
                         ((&lt; x 0) (make-interval (min (* a y) (* b x))
                                                 (max (* a x) (* b y))))
                         (<span style="color: #a020f0;">else</span> (mul-interval j i))))
          (<span style="color: #a020f0;">else</span> (<span style="color: #a020f0;">cond</span> ((&lt; y 0) (make-interval (* b x) (* a y)))
                      ((&lt; x 0) (make-interval (* b x) (* b y)))
                      (<span style="color: #a020f0;">else</span> (make-interval (* a x) (* b y))))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-12" class="outline-4">
<h4 id="sec-4-0-12">Exercise 2.12</h4>
<div class="outline-text-4" id="text-4-0-12">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-center-width</span> c w)
  (make-interval (- c w) (+ c w)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">center</span> i)
  (/ (+ (lower-bound i) (upper-bound i)) 2))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">width</span> i)
  (/ (- (upper-bound i) (lower-bound i)) 2))  
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-center-percent</span> c p)
  (make-center-width c (* c p)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">percent</span> i)
  (/ (width i) (center i)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-4-0-13" class="outline-4">
<h4 id="sec-4-0-13">Exercise 2.13</h4>
<div class="outline-text-4" id="text-4-0-13">
<p>
Let interval \(i\) have center \(c_{i}\) and tolerance \(p_{i}\). Let
interval \(j\) have center \(c_{j}\) and tolerance \(p_{j}\). Then \(i =
(c_{i}-c_{i}p_{i},c_{i}+c_{i}p_{i})\) and \(j =
(c_{j}-c_{j}p_{j},c_{j}+c_{j}p_{j})\). Suppose \(c_{i} > 0\) and \(c_{j} >
0\). Then \[i*j =
((c_{i}-c_{i}p_{i})*(c_{j}-c_{j}p_{j}),(c_{i}+c_{i}p_{i})*(c_{j}+c_{j}p_{j}))\]
\[= (c_{i}(1-p_{i})c_{j}(1-p_{j}),c_{i}(1+p_{i})c_{j}(1+p_{j}))\] \[=
(c_{i}c_{j}(1-p_{i})(1-p_{j}),c_{i}c_{j}(1+p_{i})(1+p_{j}))\] Supposing
small percentage tolerances: \[=
(c_{i}c_{j}(1-p_{i}-p_{j}),c_{i}c_{j}(1+p_{i}+p_{j}))\] Therefore \(i*j\)
is an interval centered at \(c_{i}c_{j}\) with tolerance
\(p_{i}+p_{j}\).
</p>
</div>
</div>
<div id="outline-container-sec-4-0-14" class="outline-4">
<h4 id="sec-4-0-14">Exercise 2.14</h4>
<div class="outline-text-4" id="text-4-0-14">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">add-interval</span> x y)
  (make-interval (+ (lower-bound x) (lower-bound y))
                 (+ (upper-bound x) (upper-bound y))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">par1</span> r1 r2)
  (div-interval (mul-interval r1 r2)
                (add-interval r1 r2)))

  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">par2</span> r1 r2)
    (<span style="color: #a020f0;">let</span> ((one (make-interval 1 1)))
      (div-interval one
                    (add-interval (div-interval one r1)
                                  (div-interval one r2)))))
</pre>
</div>
<p>
Let \(R_{1} = (a_{1},b_{1})\) and \(R_{2} = (a_{2},b_{2})\). Expanding, we
see: \[\frac{R_{1}R_{2}}{R_{1}+R_{2}} =
(\frac{a_{1}a_{2}}{b_{1}+b_{2}},\frac{b_{1}b_{2}}{a_{1}+a_{2}})\]
\[\frac{1}{\frac{1}{R_{1}}+\frac{1}{R_{2}}} =
(\frac{a_{1}a_{2}}{a_{1}+a_{2}},\frac{b_{1}b_{2}}{b_{1}+b_{2}})\] This
can be verified in the REPL.
</p>
</div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Section 2.2</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-0-1" class="outline-4">
<h4 id="sec-5-0-1">Exercise 2.17</h4>
<div class="outline-text-4" id="text-5-0-1">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">last-pair</span> l)
  (<span style="color: #a020f0;">if</span> (null? (cdr l))
      l
      (last-pair (cdr l))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-2" class="outline-4">
<h4 id="sec-5-0-2">Exercise 2.18</h4>
<div class="outline-text-4" id="text-5-0-2">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">reverse</span> l)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">helper</span> in out)
    (<span style="color: #a020f0;">if</span> (null? in)
        out
        (helper (cdr in) (cons (car in) out))))
  (helper l ()))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-3" class="outline-4">
<h4 id="sec-5-0-3">Exercise 2.19</h4>
<div class="outline-text-4" id="text-5-0-3">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">no-more?</span> null?)
(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">except-first-denomination</span> cdr)
(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">first-denomination</span> car)
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">cc</span> amount coin-values)
  (<span style="color: #a020f0;">cond</span> ((= amount 0) 1)
        ((<span style="color: #a020f0;">or</span> (&lt; amount 0) (no-more? coin-values)) 0)
        (<span style="color: #a020f0;">else</span>
         (+ (cc amount
                (except-first-denomination coin-values))
            (cc (- amount
                   (first-denomination coin-values))
                coin-values)))))
</pre>
</div>
<p>
The order of the list coin-values still does not affect the
output because the procedure does not rely on any assumptions
regarding the order of coin-values.
</p>
</div>
</div>
<div id="outline-container-sec-5-0-4" class="outline-4">
<h4 id="sec-5-0-4">Exercise 2.20</h4>
<div class="outline-text-4" id="text-5-0-4">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">same-parity?</span> a b)
  (= (remainder a 2) (remainder b 2)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">same-parity</span> x . l)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">filterer</span> sublist)
    (<span style="color: #a020f0;">cond</span> ((null? sublist) sublist)
          ((same-parity? x (car sublist))
           (cons (car sublist) (filterer (cdr sublist))))
          (<span style="color: #a020f0;">else</span> (filterer (cdr sublist)))))
  (cons x (filterer l)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-5" class="outline-4">
<h4 id="sec-5-0-5">Exercise 2.21</h4>
<div class="outline-text-4" id="text-5-0-5">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">square-list</span> items)
  (<span style="color: #a020f0;">if</span> (null? items)
      items
      (cons (square (car items))
            (square-list (cdr items)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">square-list-map</span> items)
  (<span style="color: #a020f0;">map</span> square items))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-6" class="outline-4">
<h4 id="sec-5-0-6">Exercise 2.22</h4>
<div class="outline-text-4" id="text-5-0-6">
<p>
Elements appearing first in the input list will be added to the head
of the ouput list before elements appearing later. Therefore, elements
appearing first in the input will appear later in the output.
</p>

<p>
Now, the output isn't a list.
</p>
</div>
</div>
<div id="outline-container-sec-5-0-7" class="outline-4">
<h4 id="sec-5-0-7">Exercise 2.23</h4>
<div class="outline-text-4" id="text-5-0-7">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">for-each</span> f l)
  (<span style="color: #a020f0;">if</span> (not (null? l))
      (<span style="color: #a020f0;">begin</span> (f (car l))
             (<span style="color: #a020f0;">for-each</span> f (cdr l)))))
</pre>
</div>
<p>
Note that "nil" is no longer a part of the Scheme standard. See this
<a href="https://stackoverflow.com/questions/9115703/null-value-in-mit-scheme">stackoverflow post</a> for more.
</p>
</div>
</div>
<div id="outline-container-sec-5-0-8" class="outline-4">
<h4 id="sec-5-0-8">Exercise 2.25</h4>
<div class="outline-text-4" id="text-5-0-8">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">l1</span> (list 1 3 (list 5 7) 9))
(car (cdr (car (cdr (cdr l1)))))
(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">l2</span> (list (list 7)))
(car (car l2))
(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">l3</span> (list 1 (list 2 (list 3 (list 4 (list 5 (list 6 7)))))))
(car (cdr (car (cdr (car (cdr (car (cdr (car (cdr (car (cdr l3))))))))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-9" class="outline-4">
<h4 id="sec-5-0-9">Exercise 2.27</h4>
<div class="outline-text-4" id="text-5-0-9">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">deep-reverse</span> l)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">helper</span> in out)
    (<span style="color: #a020f0;">if</span> (null? in)
        out
        (helper (cdr in) (cons (deep-reverse (car in)) out))))
  (<span style="color: #a020f0;">if</span> (list? l)
      (helper l ())
      l))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-10" class="outline-4">
<h4 id="sec-5-0-10">Exercise 2.28</h4>
<div class="outline-text-4" id="text-5-0-10">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fringe</span> tree)
  (<span style="color: #a020f0;">cond</span> ((not (list? tree)) (list tree))
        ((not (pair? tree)) tree)
        (<span style="color: #a020f0;">else</span> (append (fringe (car tree)) (fringe (cdr tree))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-11" class="outline-4">
<h4 id="sec-5-0-11">Exercise 2.29</h4>
<div class="outline-text-4" id="text-5-0-11">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">left-branch</span> m) (car m))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">right-branch</span> m) (car (cdr m)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">branch-length</span> b) (car b))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">branch-structure</span> b) (car (cdr b)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">mobile?</span> structure) (pair? structure))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">branch-weight</span> b)
  (<span style="color: #a020f0;">let</span> ((structure (branch-structure b)))
    (<span style="color: #a020f0;">if</span> (mobile? structure)
        (total-weight structure)
        structure)))   
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">total-weight</span> m)
  (+ (branch-weight (left-branch m))
     (branch-weight (right-branch m))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">mobile-balanced?</span> m)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">branch-balanced?</span> b)
    (<span style="color: #a020f0;">let</span> ((structure (branch-structure b)))
      (<span style="color: #a020f0;">if</span> (mobile? structure)
          (mobile-balanced? structure)
          #t)))
  (<span style="color: #a020f0;">let</span> ((left (left-branch m))
        (right (right-branch m)))
    (<span style="color: #a020f0;">and</span> (= (* (branch-length left) (branch-weight left))
            (* (branch-length right) (branch-weight right)))
         (branch-balanced? left)
         (branch-balanced? right))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-12" class="outline-4">
<h4 id="sec-5-0-12">Exercise 2.30</h4>
<div class="outline-text-4" id="text-5-0-12">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">square-tree</span> tree)
  (<span style="color: #a020f0;">cond</span> ((null? tree) tree)
        ((not (pair? tree)) (square tree))
        (<span style="color: #a020f0;">else</span> (cons (square-tree (car tree))
                    (square-tree (cdr tree))))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">square-tree-map</span> tree)
  (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (subtree)
         (<span style="color: #a020f0;">if</span> (not (pair? subtree))
             (square subtree)
             (square-tree-map subtree)))
       tree))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-13" class="outline-4">
<h4 id="sec-5-0-13">Exercise 2.31</h4>
<div class="outline-text-4" id="text-5-0-13">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">tree-map</span> f t)
  (<span style="color: #a020f0;">cond</span> ((null? t) t)
        ((not (pair? t)) (f t))
        (<span style="color: #a020f0;">else</span> (cons (tree-map f (car t))
                    (tree-map f (cdr t))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-14" class="outline-4">
<h4 id="sec-5-0-14">Exercise 2.32</h4>
<div class="outline-text-4" id="text-5-0-14">
<p>
The procedure takes advantage of the following observation. If \(x\) is
an element of set \(S\) then we can partition the subsets of \(S\) into
two categories: those that contain \(x\) and those that do not. All of
the subsets that do not contain \(x\) can be found by recursively
finding all of the subsets of \(S \setminus {x}\). All of the subsets
that do contain \(x\) are of the form \(x \cup U\) where \(U \in \wp (S
\setminus {x})\).
</p>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">subsets</span> s)
  (<span style="color: #a020f0;">if</span> (null? s)
      (list ())
      (<span style="color: #a020f0;">let</span> ((rest (subsets (cdr s))))
        (append rest (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (l) (cons (car s) l)) rest)))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-15" class="outline-4">
<h4 id="sec-5-0-15">Exercise 2.33</h4>
<div class="outline-text-4" id="text-5-0-15">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">accumulate</span> op initial sequence)
  (<span style="color: #a020f0;">if</span> (null? sequence)
      initial
      (op (car sequence)
          (accumulate op initial (cdr sequence)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">map</span> p sequence)
  (accumulate (<span style="color: #a020f0;">lambda</span> (x y) (cons (p x) y)) () sequence))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">append</span> seq1 seq2)
  (accumulate cons seq2 seq1))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">length</span> sequence)
  (accumulate (<span style="color: #a020f0;">lambda</span> (x y) (+ 1 y)) 0 sequence))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-16" class="outline-4">
<h4 id="sec-5-0-16">Exercise 2.34</h4>
<div class="outline-text-4" id="text-5-0-16">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">horner-eval</span> x coefficient-sequence)
  (accumulate (<span style="color: #a020f0;">lambda</span> (this-coeff higher-terms)
                (+ (* higher-terms x)
                   this-coeff))
              0
              coefficient-sequence))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-17" class="outline-4">
<h4 id="sec-5-0-17">Exercise 2.35</h4>
<div class="outline-text-4" id="text-5-0-17">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">count-leaves</span> t)
  (accumulate +
              0
              (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (elt)
                     (<span style="color: #a020f0;">if</span> (pair? elt)
                         (count-leaves elt)
                         1))
                   t)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-18" class="outline-4">
<h4 id="sec-5-0-18">Exercise 2.36</h4>
<div class="outline-text-4" id="text-5-0-18">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">accumulate-n</span> op init seqs)
  (<span style="color: #a020f0;">if</span> (null? (car seqs))
      ()
      (cons (accumulate op init (<span style="color: #a020f0;">map</span> car seqs))
            (accumulate-n op init (<span style="color: #a020f0;">map</span> cdr seqs)))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-19" class="outline-4">
<h4 id="sec-5-0-19">Exercise 2.37</h4>
<div class="outline-text-4" id="text-5-0-19">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">dot-product</span> v w)
  (accumulate + 0 (<span style="color: #a020f0;">map</span> * v w)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">matrix-*-vector</span> m v)
  (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (row)
         (dot-product row v))
       m))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">transpose</span> mat)
  (accumulate-n cons () mat))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">matrix-*-matrix</span> m n)
  (<span style="color: #a020f0;">let</span> ((cols (transpose n)))
    (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (row)
           (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (col)
                  (dot-product row col))
                cols))
         m)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-20" class="outline-4">
<h4 id="sec-5-0-20">Exercise 2.38</h4>
<div class="outline-text-4" id="text-5-0-20">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">fold-left</span> op initial sequence)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> result rest)
    (<span style="color: #a020f0;">if</span> (null? rest)
        result
        (iter (op result (car rest))
              (cdr rest))))
  (iter initial sequence))
(<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">fold-right</span> accumulate)

(fold-right / 1 (list 1 2 3)) <span style="color: #b22222;">; </span><span style="color: #b22222;">3/2</span>
(fold-left / 1 (list 1 2 3)) <span style="color: #b22222;">; </span><span style="color: #b22222;">1/6</span>
(fold-right list () (list 1 2 3)) <span style="color: #b22222;">; </span><span style="color: #b22222;">(1 (2 (3 ())))</span>
(fold-left list () (list 1 2 3)) <span style="color: #b22222;">; </span><span style="color: #b22222;">(((() 1) 2) 3)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-21" class="outline-4">
<h4 id="sec-5-0-21">Exercise 2.39</h4>
<div class="outline-text-4" id="text-5-0-21">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">reverse</span> sequence)
  (fold-right (<span style="color: #a020f0;">lambda</span> (x y) (append y (list x))) () sequence))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">reverse</span> sequence)
  (fold-left (<span style="color: #a020f0;">lambda</span> (x y) (cons y x)) () sequence))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-22" class="outline-4">
<h4 id="sec-5-0-22">Exercise 2.40</h4>
<div class="outline-text-4" id="text-5-0-22">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">enumerate-interval</span> k)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> curr result)
    (<span style="color: #a020f0;">if</span> (= curr 0)
        result
        (iter (- curr 1) (cons curr result))))
  (iter k ()))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">unique-pairs</span> n)
  (flatmap (<span style="color: #a020f0;">lambda</span> (i)
             (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (j)
                    (list i j))
                  (enumerate-interval (- i 1))))
           (enumerate-interval n)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-23" class="outline-4">
<h4 id="sec-5-0-23">Exercise 2.41</h4>
<div class="outline-text-4" id="text-5-0-23">
<div class="org-src-container">

<pre class="src src-scheme"><span style="color: #b22222;">;; </span><span style="color: #b22222;">This is slow...</span>
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">unique-tuples</span> n max)
  (<span style="color: #a020f0;">cond</span> ((= n 0) (list ()))
        ((&lt; max n) ())
        ((= max n) (list (reverse (enumerate-interval n))))
        (<span style="color: #a020f0;">else</span> (append (unique-tuples n (- max 1))
                      (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (t)
                             (cons max t))
                           (unique-tuples (- n 1) (- max 1)))))))
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(define (unique-tuples n max)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(define (iter tuples)</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(if (= (length (car tuples)) 0)</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">tuples</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">(iter (flatmap (lambda (l)</span>
<span style="color: #b22222;">;;                          </span><span style="color: #b22222;">(if))))))</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(if (&lt; max n)</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">()</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">(flatmap values</span>
<span style="color: #b22222;">;;                </span><span style="color: #b22222;">(iter (map list</span>
<span style="color: #b22222;">;;                           </span><span style="color: #b22222;">(reverse (enumerate-interval n)))))))</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">;; And this doesn't work...</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">(define (unique-tuples n max)</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(define (next-tuple tuple)</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(define (cons-next-tuple min t)</span>
<span style="color: #b22222;">;;       </span><span style="color: #b22222;">(cond ((null? t) t)</span>
<span style="color: #b22222;">;;             </span><span style="color: #b22222;">((null? (cdr t)) t)</span>
<span style="color: #b22222;">;;             </span><span style="color: #b22222;">((= (car t) (- (cadr t) 1))</span>
<span style="color: #b22222;">;;              </span><span style="color: #b22222;">(cons min (cons-next-tuple (+ min 1) (cdr t))))</span>
<span style="color: #b22222;">;;             </span><span style="color: #b22222;">(else (cons (+ 1 (car t)) (cdr t)))))</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(cons-next-tuple 1 tuple))</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(define (iter t result)</span>
<span style="color: #b22222;">;;     </span><span style="color: #b22222;">(if (&gt; (car t) max)</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">result</span>
<span style="color: #b22222;">;;         </span><span style="color: #b22222;">(iter (next-tuple t) (cons t result))))</span>
<span style="color: #b22222;">;;   </span><span style="color: #b22222;">(iter (enumerate-interval n) ()))</span>
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">sum-list</span> l)
  (fold-left + 0 l))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">bounded-partition</span> n parts bound)
  (filter (<span style="color: #a020f0;">lambda</span> (t)
            (= n (sum-list t)))
          (unique-tuples parts bound)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">bounded-paritition-3</span> total bound)
  (bounded-partition total 3 bound))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-24" class="outline-4">
<h4 id="sec-5-0-24">Exercise 2.42</h4>
<div class="outline-text-4" id="text-5-0-24">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-queen</span> row col)
  (list row col))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">get-row</span> queen)
  (car queen))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">get-col</span> queen)
  (cadr queen))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">queens</span> board-size)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">adjoin-position</span> row col board)
    (cons (make-queen row col) board))
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">safe?</span> col board)
    (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">same-diag?</span> q1 q2)
      (= (difference (get-row q1) (get-row q2))
         (difference (get-col q1) (get-col q2))))
    (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">same-row?</span> q1 q2)
      (= (get-row q1) (get-row q2)))
    (<span style="color: #a020f0;">let</span> ((new-queen (car board)))
      (fold-right (<span style="color: #a020f0;">lambda</span> (x y) (<span style="color: #a020f0;">and</span> x y))
                  #t
                  (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (q)
                         (<span style="color: #a020f0;">and</span> (not (same-row? new-queen q))
                              (not (same-diag? new-queen q))))
                       (cdr board)))))
  (<span style="color: #a020f0;">define</span> <span style="color: #0000ff;">empty-board</span> ())
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">queen-cols</span> k)
    (<span style="color: #a020f0;">if</span> (= k 0)
        (list empty-board)
        (filter
         (<span style="color: #a020f0;">lambda</span> (positions) (safe? k positions))
         (flatmap
          (<span style="color: #a020f0;">lambda</span> (rest-of-queens)
            (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (new-row)
                   (adjoin-position new-row k rest-of-queens))
                 (enumerate-interval board-size)))
          (queen-cols (- k 1))))))
  (queen-cols board-size))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">repeat-display</span> n str)
  (<span style="color: #a020f0;">if</span> (&gt; n 0)
      (<span style="color: #a020f0;">begin</span>
        (display str)
        (whitespace (- n 1)))))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">print-queens</span> board)
  (<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">iter</span> left)
    (<span style="color: #a020f0;">if</span> (not (null? left))
        (<span style="color: #a020f0;">let</span> ((row (get-row (car left))))
          (repeat-display (- row 1) <span style="color: #8b2252;">"."</span>)
          (display <span style="color: #8b2252;">"Q"</span>)
          (repeat-display (- (length board) row) <span style="color: #8b2252;">"."</span>)
          (newline)
          (iter (cdr left)))))
  (iter board))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">show-queens</span> n)
  (<span style="color: #a020f0;">map</span> (<span style="color: #a020f0;">lambda</span> (soln)
         (print-queens soln)
         (newline))
       (queens n)))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-25" class="outline-4">
<h4 id="sec-5-0-25">Exercise 2.43</h4>
<div class="outline-text-4" id="text-5-0-25">
<p>
In the provided <code>queens</code> procedure, the \(n \times (k-1)\) subproblem is
solved once. Then, for each solution of the subproblem, several
candidate solutions for the \(n \times k\) problem are created by adding
a new column with a queen in each possible row.
</p>

<p>
Louis's procedure calculates each possible row once (in the call to
<code>enumerate-interval</code>). Then, for each row, the procedure calculates
the \(n \times (k-1)\) subproblem. So, at each level of the process, the
subproblem is solved \(n\) times. Therefore, in Louis' procedure, the
base-case \(n \times 0\) problem, computed by <code>(queens 0)</code>, is
calculated \(n^{n}\) times. Louis' procedure solves the puzzle in
approximately time \(n^{n}T\).
</p>
</div>
</div>
<div id="outline-container-sec-5-0-26" class="outline-4">
<h4 id="sec-5-0-26">Exercise 2.44</h4>
<div class="outline-text-4" id="text-5-0-26">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">up-split</span> painter n)
  (<span style="color: #a020f0;">if</span> (= n 0)
      painter
      (<span style="color: #a020f0;">let</span> ((smaller (up-split painter (- n 1))))
        (below painter (beside smaller smaller)))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-27" class="outline-4">
<h4 id="sec-5-0-27">Exercise 2.45</h4>
<div class="outline-text-4" id="text-5-0-27">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">split</span> outer inner)
  (<span style="color: #a020f0;">lambda</span> (painter n)
    (<span style="color: #a020f0;">if</span> (= n 0)
        painter
        (<span style="color: #a020f0;">let</span> ((smaller ((split outer inner) painter (- n 1))))
          (outer painter (inner smaller smaller))))))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-28" class="outline-4">
<h4 id="sec-5-0-28">Exercise 2.46</h4>
<div class="outline-text-4" id="text-5-0-28">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-vect</span> x y) (cons x y))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">xcor-vect</span> v) (car v))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">ycor-vect</span> v) (cdr v))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">add-vect</span> v1 v2) )
</pre>
</div>
<p>
I'll leave this exercise here.
</p>
</div>
</div>
<div id="outline-container-sec-5-0-29" class="outline-4">
<h4 id="sec-5-0-29">Exercise 2.47</h4>
<div class="outline-text-4" id="text-5-0-29">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-frame</span> origin edge1 edge2)
  (list origin edge1 edge2))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">origin-frame</span> frame)
  (car frame))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">edge1-frame</span> frame)
  (cadr frame))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">edge2-frame</span> frame)
  (caddr frame))
</pre>
</div>
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-frame</span> origin edge1 edge2)
  (cons origin (cons edge1 edge2)))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">origin-frame</span> frame)
  (car frame))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">edge1-frame</span> frame)
  (cadr frame))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">edge2-frames</span> frame)
  (cddr frame))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-30" class="outline-4">
<h4 id="sec-5-0-30">Exercise 2.48</h4>
<div class="outline-text-4" id="text-5-0-30">
<div class="org-src-container">

<pre class="src src-scheme">(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">make-segment</span> v1 v2)
  (cons v1 v2))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">start-segment</span> v) (car v))
(<span style="color: #a020f0;">define</span> (<span style="color: #0000ff;">end-segment</span> v) (cdr v))
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-0-31" class="outline-4">
<h4 id="sec-5-0-31">Exercise 2.49</h4>
<div class="outline-text-4" id="text-5-0-31">
<div class="org-src-container">

<pre class="src src-scheme"> (<span style="color: #a020f0;">define</span> ())
def
</pre>
</div>
</div>
</div>
</div>
</div><div class="col-md-3"><nav id="table-of-contents">
<div id="text-table-of-contents" class="bs-docs-sidebar">
<ul class="nav">
<li><a href="#sec-1">Section 1.1</a></li>
<li><a href="#sec-2">Section 1.2</a></li>
<li><a href="#sec-3">Section 1.3</a></li>
<li><a href="#sec-4">Section 2.1</a></li>
<li><a href="#sec-5">Section 2.2</a></li>
</ul>
</div>
</nav>
</div></div></div>
<footer id="postamble" class="">
<div><p class="author">Author: Tanner Hoelzel</p>
<p class="date">Created: 2020-05-20 Wed 22:45</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 26.3 (<a href="http://orgmode.org">Org-mode</a> 9.1.9)</p>
</div>
</footer>
</body>
</html>
